import{r as M,R as B,c as ke,g as Io,b as Do}from"./react-67787288.js";import{u as Ve,e as ge,f as vt,g as Mo,i as Oe,j as Ue,k as Eo,l as Vo,P as Oo}from"./redux-5cd25d2f.js";import{u as yt,c as $o,a as Fo,T as ee,I as te,b as T,B as E,D as me,d as fe,L as be,e as q,f as Yt,m as $e,g as Bo,h as je,i as Ze,j as Se,k as z,C as xt,l as ue,F as bt,n as Xt,o as Qt,p as Pe,S as Ge,q as et,r as Jt,s as jt,t as St,v as wt,w as he,x as ne,y as qe,z as Rr,A as Lt,E as _r,G as kr,H as mt,J as Wo,K as ut,M as Ae,N as Lo,O as fr,P as Ct,Q as Kt,R as Rt,U as No,V as Ar,W as zo,X as Ho,Y as Uo,Z as qo,_ as Pr,$ as Go,a0 as Yo,a1 as Xo,a2 as Qo,a3 as tt,a4 as nt,a5 as rt,a6 as Tr,a7 as Jo,a8 as Ir,a9 as Ko,aa as Zo,ab as ei,ac as ti,ad as ni}from"./mui-85c4ad07.js";import{C as Zt,F as Nt,u as _t,t as ri,f as ai,a as oi,c as Te,b as K,d as Q,e as ii,g as Me}from"./hookform-011cd7de.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const h of s.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}})();var e={},si={get exports(){return e},set exports(t){e=t}},at={};/** @license React v17.0.2
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var li=M,Dr=60103;at.Fragment=60107;if(typeof Symbol=="function"&&Symbol.for){var pr=Symbol.for;Dr=pr("react.element"),at.Fragment=pr("react.fragment")}var ci=li.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ui=Object.prototype.hasOwnProperty,di={key:!0,ref:!0,__self:!0,__source:!0};function Mr(t,n,a){var r,o={},s=null,h=null;a!==void 0&&(s=""+a),n.key!==void 0&&(s=""+n.key),n.ref!==void 0&&(h=n.ref);for(r in n)ui.call(n,r)&&!di.hasOwnProperty(r)&&(o[r]=n[r]);if(t&&t.defaultProps)for(r in n=t.defaultProps,n)o[r]===void 0&&(o[r]=n[r]);return{$$typeof:Dr,type:t,key:s,ref:h,props:o,_owner:ci.current}}at.jsx=Mr;at.jsxs=Mr;(function(t){t.exports=at})(si);const U=Ve,D=ge,Er=vt({name:"appState",initialState:{feedback:{open:!1,message:"",severity:"info"},inputUpdate:!1,autoDarkMode:!1,customizeMode:!1},reducers:{toggleForceInputUpdate:t=>{t.inputUpdate=!t.inputUpdate},closeFeedback:t=>{t.feedback.open=!1},showFeedback:{reducer:(t,n)=>{const[a,r]=n.payload;t.feedback={open:!0,message:a,severity:r}},prepare:(t,n)=>({payload:[t,n]})},setAutoDarkMode:(t,n)=>{t.autoDarkMode=n.payload},setCustomizeMode:(t,n)=>{t.customizeMode=n.payload}}}),{toggleForceInputUpdate:en,closeFeedback:hi,showFeedback:ie,setAutoDarkMode:mi,setCustomizeMode:Vr}=Er.actions,fi=Er.reducer,pi=()=>{const t=U(),n=yt("(prefers-color-scheme: dark)"),a=D(s=>s.ui.darkMode),r=a===void 0?n:a;return t(mi(r)),B.useMemo(()=>$o({palette:{type:r?"dark":"light",primary:{main:"#006B3C"}},typography:{h2:{fontWeight:400,fontSize:"2.125rem",lineHeight:1.235,letterSpacing:"0.00735em"},h3:{fontWeight:400,fontSize:"1.5rem",lineHeight:1.334,letterSpacing:"0em"},h4:{fontWeight:500,fontSize:"1.25rem",lineHeight:1.6,letterSpacing:"0.0075em"},h5:{fontWeight:500,fontSize:"1.1rem",lineHeight:1.6,letterSpacing:"0.0075em"},h6:{fontWeight:400,fontSize:"1.1rem",lineHeight:1.6,letterSpacing:"0.0075em"}}}),[r])},gi={"Mental Command":{name:"Mental Command",difficulty:6,target:'Friendly unit within 18"',duration:"Until start of player's next activation phase, or until used.",effect:"If the target unit fails its next ordered activation, it may immediately re-roll the test once. The power’s effects end immediately, whether the re-roll is successful or not.",short:"Target may re-roll failed activation."},"Soothed Mind":{name:"Soothed Mind",difficulty:6,target:'Friendly unit within 18"',duration:"Until the start of the player's next activation phase.",effect:"The target unit may re-roll all failed Courage tests once per test.",short:"Target may re-roll all failed Courage tests."},Summoner:{name:"Summoner",difficulty:6,target:"Any friendly unit with Special Insertion and held in reserve.",duration:"Instantaneous",effect:'Place the target unit onto the table anywhere within 12" of the Manifesting unit, but at least 6” from any enemy units.',short:'Place the target unit onto the table anywhere within 12".'},"Psychic Healing":{name:"Psychic Healing",difficulty:7,target:'Friendly infantry unit within 18"',duration:"Instantaneous",effect:"Restore 1 lost Strength Point to a friendly infantry unit, as long as it does not have the Mechanoid xeno rule.",short:"Restore 1 lost Strength Point to an infantry unit."},"Machine Friend":{name:"Machine Friend",difficulty:7,target:'Friendly vehicle or Mechanoid unit within 18".',duration:"Instantaneous",effect:"Restore 1 lost Strength Point to a friendly vehicle unit or infantry unit with the Mechanoid xeno rule.",short:"Restore 1 lost Strength Point to a vehicle unit."},"Visions of Terror":{name:"Visions of Terror",difficulty:7,target:'Enemy unit within 18" that is not Suppressed.',duration:"Until the unit Rallies.",effect:"Suppresses the target unit. May not be used on an already Suppressed unit.",short:"Suppresses the target unit."},Paralysis:{name:"Paralysis",difficulty:7,target:'Enemy unit within 18"',duration:"Until the end of the target’s next activation phase.",effect:"Any movement or combat the target unit is involved in counts as in rough terrain; this does not affect any other units. If the target unit moves into ‘real’ rough terrain, movement is reduced to 1⁄4 of normal speed.",short:"Any movement or combat of the target unit counts as in rough terrain."},Concealment:{name:"Concealment",difficulty:7,target:'Self or friendly unit within 18"',duration:"Until the end of the target’s next activation phase.",effect:'The target unit can only be targeted by Attacks or Shooting from within 12" of it.',short:'Target unit can only be targeted by Attacks or Shooting from within 12".'},"Guiding Eye":{name:"Guiding Eye",difficulty:7,target:'Self or friendly unit within 18"',duration:"Until the start of the player’s next activation phase.",effect:"The target unit may re-roll all failed Shoot or Firefight dice.",short:"Target unit may re-roll all failed Shooting dice."},"Guiding Hand":{name:"Guiding Hand",difficulty:7,target:'Self or friendly unit within 18"',duration:"Until the start of the player’s next activation phase.",effect:"The target unit may re-roll all failed Attack or Defence dice.",short:"Target unit may re-roll all failed Attack or Defence dice."},"Psychic Shield":{name:"Psychic Shield",difficulty:7,target:'Self or friendly unit within 18"',duration:"Until the start of the player’s next activation phase.",effect:"The target unit’s Armour is increased by 1.",short:"Target unit’s Armour is increased by 1."},Transportation:{name:"Transportation",difficulty:7,target:'Self or any unit within 18"',duration:"Instantaneous",effect:"Roll two dice. The target unit is moved, whether by teleportation, telekinesis, or portals ripped in space-time, up to that many inches in a direction chosen by the Manifesting unit’s player.",short:"Target unit is moved 2d6 inches."},Annulment:{name:"Annulment",difficulty:8,target:'One unit currently affected by a psychic power within 18".',duration:"Instantaneous",effect:"Cancel the effect of any psychic powers currently affecting the target unit with a duration other than ‘Instantaneous’.",short:"Cancel the effect of a psychic power."}},_={"All-Terrain":{name:"All-Terrain",points:1,description:"This unit does not halve its movement in rough terrain.",short:"Move through terrain.",add:["All-Terrain"]},"Anti-Tank":{name:"Anti-Tank",points:2,description:"When Shooting at enemy vehicle units (including when using the Firefight rule), count the target's armor as being half its usual value. This cannot be combined with the effects of armor-Piercing.",short:"When Shooting, armor of enemy vehicle units is halved.",add:["Anti-Tank"],disabledBy:["Armor-Piercing"]},"Area Effect":{name:"Area Effect",points:1,description:"Ignore cover when Shooting",short:"Ignore cover when Shooting",add:["Area Effect"]},Armored:{name:"Armored",points:1,description:"This unit is wearing primitive metal armor or has naturally resilient scales, plates or leathery skin. This unit counts as armor 2 when Attacking or Defending, or against Shooting attacks from Primitive Infantry or Militia Rabble only; against all other sources of harm, they are their usual armor 1.",short:"Armor 2 when Attacking or Defending, or against Shooting attacks from Primitive Infantry or Militia Rabble only.",add:["Armored"]},"Armor-Piercing":{name:"Armor-Piercing",points:1,description:"When Shooting (including when using the Firefight rule), count the target's armor as being 1 point lower than usual.",short:"When Shooting, enemy armor -1.",add:["Armor-Piercing"],disabledBy:["Anti-Tank"]},Artillery:{name:"Artillery",points:2,description:`This unit's Shoot Value becomes 4+ / 48". If this vehicle targets an enemy that is within 12" of a friendly unit that has not been activated this turn, the friendly unit may forgo its action this turn to act as spotters. Spotters improve the vehicle's Shoot Value to 3+ / 48" for this action only. Cannot be combined with Close Quarters Doctrine.`,short:'Shoot range 48". Shooting value of 3+ against enemies in 12" of friendly unit which forgoes its activation.',setStats:{shootRange:48},add:["Artillery"],disabledBy:["Close Quarters Doctrine"]},"Assault Doctrine":{name:"'Assault Doctrine'",points:2,description:"Bayonets or more traditional melee weapons improve this unit's Attack Value by 1",short:"Attack Value increased by 1.",adjustStats:{attackValue:-1}},"Close Quarters Doctrine":{name:"Close Quarters Doctrine",points:-1,description:'This unit is armed for short-range combat, reducing its Shooting Range to 12".',short:'Reduced Shooting Range of 12".',setStats:{shootRange:12},disabledBy:["Artillery"]},"Combat Engineering Vehicle":{name:"Combat Engineering Vehicle",points:1,description:"This vehicle is fitted out with heavy equipment for clearing mines or demolishing obstructions. If it Attacks a building, the building only hits on Defence rolls of 6.",short:"Attacked Buildings only hits on Defence rolls of 6.",add:["Combat Engineering Vehicle"]},"Counter-Sniper Training":{name:"Counter-Sniper Training",points:1,description:' A unit with the Sniper Team option can be trained as counter-snipers. This allows them to target enemy units with the Hard to Target Special rule (usually enemy Recon Infantry) at ranges beyond 12".',short:'Can target enemy units with the Hard to Target rule beyond 12".',add:["Counter-Sniper Training"],enabledBy:["Sniper Team"]},Demolitions:{name:"Demolitions",points:2,description:"During Attacks (whether Attacking or Defending), count the armor of enemy vehicle units as being half its usual value. This cannot be combined with the effects of High-Powered Blades.",short:"During Attacks, armor of enemy vehicle units is halved.",add:["Demolitions"],disabledBy:["High-Powered Blades"]},Engulfing:{name:"Engulfing",points:1,description:"This unit's Shooting targets gain no armor bonus from cover.",short:"Shooting targets gain no armor from cover.",add:["Engulfing"]},"Fire Support":{name:"Fire Support",points:4,description:"This unit can call in Fire Support as an ordered activation.",short:"Call in Fire Support as an ordered activation.",add:["Fire Support"]},"Green Recons":{name:"Green Recons",points:-1,description:"This unit cannot use the Skirmish rule. This cannot be combined with Sniper Team or Veterans.",short:"This unit cannot use the Skirmish rule.",add:["Green Recons"],disabledBy:["Sniper Team","Veteran Recons"]},Guerrillas:{name:"Guerrillas",points:1,description:"When in soft cover, this unit increases its armor value by an additional point.",short:"When in soft cover, armor +1.",add:["Guerrillas"]},"Heavy Weapon":{name:"Heavy Weapon",points:2,description:"When Shooting (including when using the Firefight rule), any 6s count as two hits, rather than one.",short:"When Shooting, any 6s count as two hits.",add:["Heavy Weapon"]},"High-Powered Blades":{name:"High-Powered Blades",points:1,description:"During Attacks (whether Attacking or Defending), count the target's armor as being one point lower than usual.",short:"During Attacks, enemy armor -1.",add:["High-Powered Blades"],disabledBy:["Demolitions"]},"Indirect Fire":{name:"Indirect Fire",points:1,description:"When using the Spotters rule, this unit may fire at targets that it cannot draw a line of sight to, as long as the unit acting as spotters can do so.",short:"Can use Spotters line of sight.",add:["Indirect Fire"]},Mobile:{name:"Mobile",points:1,description:`The use of exo-skeletons, powered armor or mounts increases this unit's Maximum Movement by 4". This unit still counts, for all rules purposes, as infantry. This cannot be combined with the Slow xeno rule.`,short:'Maximum Movement increased by 4".',adjustStats:{movement:4}},"Primitive Missiles":{name:"Primitive Missiles",points:1,description:'This unit is armed with javelins, bows, slings, or perhaps muskets, granting it Shoot 6+ and Shoot Value 6 / 6". However, against any opponents other than Greater or Lesser Xenomorphs, Primitive Infantry, or Militia Rabble, targets count as having one more point of armor. Cannot be combined with Savages.',short:'Shoot 6+ and Shoot Value 6 / 6". Some units get +1 armor vs this.',setStats:{shoot:6,shootValue:6,shootRange:6},add:["Primitive Missiles"],disabledBy:["Savages"]},"Sniper Team":{name:"Sniper Team",points:2,description:`This unit's Shoot Value becomes 5+ / 24", but it cannot use the Skirmish rule. This cannot be combined with Green or Veterans.`,short:"This unit cannot use the Skirmish rule.",setStats:{shootValue:5,shootRange:24},add:["Sniper Team"],disabledBy:["Green Recons","Veteran Recons"]},"Super Heavy armor":{name:"Super Heavy armor",points:2,description:`You don't think they're tough enough already? Some Elite Infantry boast carapaces more suited to an armored vehicle. Increase this unit's armor to 5, but reduce its Maximum Movement by 2". Super-heavily armored infantry also become susceptible to the Anti-Tank and Demolitions rules, as if they were vehicles.`,short:'Armor 5, Movement -2". Susceptible to Anti-Tank and Demolitions.',setStats:{armor:5},adjustStats:{movement:-2},add:["Super Heavy armor"]},Undisciplined:{name:"Undisciplined",points:-1,description:"The unit has Courage 5+.",short:"The unit has Courage 5+.",setStats:{courage:5}},"Veteran Crew":{name:"Veteran Crew",points:2,description:"This unit can move and fire without the usual -1 penalty. This cannot be combined with Green Crew.",short:"Can move and fire without the -1 penalty.",add:["Veteran Crew"],disabledBy:["Green Crew"]},"Veteran Recons":{name:"Veteran Recons",points:2,description:"This unit Skirmishes at its normal Shoot Value. This cannot be combined with Green or Sniper Team.",short:"Skirmishes at the normal Shoot Value.",add:["Veteran Recons"],disabledBy:["Green Recons","Sniper Team"]},Walker:{name:"Walker",points:2,description:'This vehicle walks, by means bipedal, quadrupedal, or creepily crab-like. Its Maximum Movement is reduced by 2", but its Attack Value becomes 4+. Walkers are able to Storm defences if they win an Attack action, while buildings they Attack do not get to Defend.',short:'Movement -2", Attack Value 4+. Storm defences.',setStats:{attackValue:4},adjustStats:{movement:-2},add:["Walker"]}},vi={"Back Into The Fray":{name:"Back Into The Fray",description:"If Elite Infantry ever fall back under fire, they are merely withdrawing to find a better position to try another assault. On the turn that a unit of Elite Infantry carries out a successful Rally action, it can also take an ordered activation, which requires an activation test even if it would normally be a Free Action.",short:"Can make an ordered activation after rallying."},"Counter-Charge":{name:"Counter-Charge",description:"When an enemy infantry unit with a Maximum Movement equal to or less than this unit's Maximum Movement has successfully rolled to Attack this unit, but before it moves, this unit may test for a Counter-Charge. This is an Attack at 7+. If it succeeds, the unit charges half its Maximum Movement distance prior to the enemy unit's own charge into contact and both count as Attacking. If it fails, it stands in place for the enemy's charge and counts as Defending as normal. Counter-Charge may not be used if the unit is Suppressed.",short:"On 7+ move half towards attacker and count as attacking too."},Firefight:{name:"Firefight",description:"This unit may attempt a Firefight reaction against the first enemy unit that fires on it each turn.",short:"Can return fire."},"Go To Ground":{name:"Go To Ground",description:"This unit may Go To Ground as a Move action, instead of moving, which grants them +1 Armour against incoming Shooting, in addition to any benefits from cover. If subjected to an Attack while Gone To Ground, the unit’s Defence Value is treated as 5+.",short:"Go To Ground as a Move action. +1 armor vs shooting, defense value 5+."},"Hard to Target":{name:"Hard to Target",description:'The unit counts as armor 2 versus Shoot actions and may only be targeted by enemy units within 12".',short:'Armor 2 vs shooting, may only targeted by units in 12".'},"Line-Breaker":{name:"Line-Breaker",description:"This unit is not slowed by linear obstacles such as barricades, barbed wire, low walls, fences or trench parapets. In the case of obstacles that could plausibly be crushed beneath the vehicle, you can remove an appropriately sized stretch of the obstacle after the unit passes over it.",short:"Can move through linear obstacles."},"Never Attacks":{name:"Never Attacks",description:"Support Infantry cannot use Attack actions. Should they somehow acquire the Wild Charge rule and be required to act in the Wild Charge phase, they will attempt a Shoot action at the target instead of Attack.",short:"Can not attack."},"Open Order":{name:"Open Order",description:"This unit does not halve its movement in rough terrain.",short:"Move normally through rough terrain."},Ranger:{name:"Ranger",description:"This unit uses its normal Attack/Defence/armor profile when fighting in rough terrain.",short:"Use the normal Attack/Defence/armor profile when fighting in rough terrain."},Skirmish:{name:"Skirmish",description:'As an ordered activation, successful on a 7+, this unit may choose to both Move up to half its Maximum Movement and Shoot, in either order. This unit treats its Shoot Value as 6+ / 12" when Skirmishing.',short:'On 7+ move and shoot. Shoot value 6+ /12".'},Spotters:{name:"Spotters",description:`If a unit of Support Infantry targets an enemy that is within 12" of a friendly unit that has not been activated this turn, that friendly unit may forgo its action this turn to act as spotters. Spotters improve the Support Infantry's Shoot Value to 3+ for this action only. Unless the Support Infantry has the Indirect Fire option, it must be able to draw line of sight to the enemy as normal.`,short:'Shooting value of 3+ against enemies in 12" of friendly unit which forgoes its activation.'},Vehicle:{name:"Vehicle",description:"This unit is a vehicle and subject to all the relevant rules."},"Wild Charge":{name:"Wild Charge",description:"If the unit is within Attack range of an enemy unit, you must test to activate an Attack; this is the only order the unit can be given. Wild Charge may not be used if the unit is Battered.",short:"Unit must attack if able."}},yi=Object.entries(_).reduce((t,[n,a])=>({...t,[n]:{name:a.name,description:a.description,short:a.short}}),{}),xi={...vi,...yi},bi={Timid:{name:"Timid",description:"The Commander’s unit may not be given an Attack order (but will still make Wild Charges if applicable).",short:"The Commander’s unit may not be given an Attack order.",category:"Aggressive"},Insipid:{name:"Insipid",description:'No Courage bonus to units within 12".',category:"Aggressive"},"Attack, Attack, Attack!":{name:"Attack, Attack, Attack!",description:"The Commander’s unit gains the Wild Charge rule; if it already has the Wild Charge rule, then it automatically passes any tests for Wild Charge.",short:"Gains Wild Charge; if already, automatically passes it.",category:"Aggressive"},"Extreme Disciplinarian":{name:"Extreme Disciplinarian",description:'The unit gains the Brutal Leader xeno rule, for free, with a range of 12".',category:"Aggressive"},Brave:{name:"Brave",description:"The Commander’s unit ignores the effects of Fearsome opponents.",category:"Aggressive"},"Fix Bayonets!":{name:"Fix Bayonets!",description:'Each turn, one unit within 12" of your Commander model may treat Attack as a free action.',category:"Aggressive"},Indecisive:{name:"Indecisive",description:'Friendly units do not receive the +1 modifier to ordered activations when within 12" of the Commander.',category:"Tactical"},Reactive:{name:"Reactive",description:"You must subtract one from your roll to determine Attacker and Defender.",category:"Tactical"},Commanding:{name:"Commanding",description:'You may reroll a failed Move, Attack or Shoot order within 12" of your Commander model, once per turn.',category:"Tactical"},Manoeuvres:{name:"Manoeuvres",description:'Each turn, one unit within 12" of your Commander model may treat Move as a free action.',category:"Tactical"},"Shooting Drill":{name:"Shooting Drill",description:'Each turn, one unit within 12" of your Commander model may treat Shoot as a free action.',category:"Tactical"},"Hold The Line!":{name:"Hold The Line!",description:'Each turn, one unit within 12" of your Commander model may ignore a compulsory Wild Charge, and may instead take an ordered action in your ordered activation phase.',short:'One unit within 12" may ignore a compulsory Wild Charge, and take an ordered action.',category:"Tactical"},"Incompetent Paper Pusher":{name:"Incompetent Paper Pusher",description:"Your Detachment is 2 points smaller than it should be.",category:"Strategic"},"Half-Wit":{name:"Half-Wit",description:"After deployment (whether your Commander is on the table or not) roll one die for each of your units other than the Commander’s. On a roll of 1, that unit never received its orders and is immediately removed from play (not counting as casualties). Only one unit will fail to arrive per game; once a unit has been removed, stop rolling.",short:"After deployment roll one die for each of your units other than the Commander’s. On a roll of 1, remove it from play. Only one unit will fail to arrive per game.",category:"Strategic"},Wise:{name:"Wise",description:"You may add or subtract 1 from your final total when rolling to decide Attacker and Defender.",category:"Strategic"},"Father To His Men":{name:"Father To His Men",description:"You may reroll a Courage test within 12” of your Commander, once per turn.",category:"Strategic"},Unpredictable:{name:"Unpredictable",description:"In games where you deploy before the other player, you may swap the positions of up to three units after the other player has deployed. All units must occupy the space vacated by another of the units that has been redeployed.",short:"If you deploy first, you may swap the positions of up to three units after the other player has deployed.",category:"Strategic"},Logistician:{name:"Logistician",description:"You can spend 2 extra points on your Detachment.",category:"Strategic"},Runt:{name:"Runt",description:"Your Commander’s unit rolls one fewer die for all Attack and Shoot actions",category:"Warlord"},Craven:{name:"Craven",description:"Your Commander’s unit takes -1 to all Courage tests",category:"Warlord"},Elite:{name:"Elite",description:"The Commander’s unit may take one of Move, Shoot, or Attack as an additional free action.",category:"Warlord"},"Strong-Willed":{name:"Strong-Willed",description:"Your Commander’s unit may not be targeted by enemy psychic powers.",category:"Warlord"},"Crack Shot":{name:"Crack Shot",description:"When shooting (whether as a Shoot action or when using the Firefight rule), your Commander’s unit may reroll up to two failed hit dice.",short:"When shooting, your Commander’s unit may reroll up to two failed hit dice.",category:"Warlord"},Champion:{name:"Champion",description:"During Attacks (whether attacking or defending), your Commander’s unit may reroll up to two failed hit dice.",short:"During close combat, your Commander’s unit may reroll up to two failed hit dice.",category:"Warlord"}},ji={Unit:{name:"Unit",type:"foot",points:0,stats:{attack:0,move:0,shoot:0,courage:0,armor:0,attackValue:0,defenceValue:0,shootValue:0,shootRange:0,movement:0,strengthPoints:0},freeActivations:[],rules:[],options:{},xenosRules:[]},"Elite Infantry":{name:"Elite Infantry",type:"foot",points:6,stats:{attack:5,move:5,shoot:5,courage:3,armor:4,attackValue:4,defenceValue:4,shootValue:4,shootRange:18,movement:8,strengthPoints:5},freeActivations:["attack","shoot"],rules:["Back Into The Fray","Firefight","Ranger"],options:{"Anti-Tank":_["Anti-Tank"],"Armor-Piercing":_["Armor-Piercing"],"Assault Doctrine":_["Assault Doctrine"],"Close Quarters Doctrine":_["Close Quarters Doctrine"],Demolitions:_.Demolitions,"Fire Support":_["Fire Support"],"Heavy Weapon":_["Heavy Weapon"],"High-Powered Blades":_["High-Powered Blades"],Mobile:_.Mobile,"Super Heavy armor":_["Super Heavy armor"]},xenosRules:[]},"Heavy Infantry":{name:"Heavy Infantry",type:"foot",points:2,stats:{attack:6,move:5,shoot:6,courage:4,armor:3,attackValue:6,defenceValue:5,shootValue:6,shootRange:18,movement:6,strengthPoints:5},freeActivations:["shoot"],rules:["Firefight","Go To Ground"],options:{"Armor-Piercing":_["Armor-Piercing"],"Assault Doctrine":_["Assault Doctrine"],"Close Quarters Doctrine":_["Close Quarters Doctrine"],"Fire Support":_["Fire Support"],"Heavy Weapon":_["Heavy Weapon"],"Increased Squad Size":{name:"Increased Squad Size",points:2,description:'This unit begins the game with 10 Strength Points and increases its Attack Value to 5+, Defence Value to 4+ and Shoot Value to 5+/18".',short:'10 Strength Points. Attack Value 5+, Defence Value 4+ , Shoot Value 5+/18".',setStats:{attackValue:5,defenceValue:4,shootValue:5,shootRange:18,strengthPoints:10}},Mobile:_.Mobile,Undisciplined:_.Undisciplined},xenosRules:[]},"Light Infantry":{name:"Light Infantry",type:"foot",points:1,stats:{attack:6,move:5,shoot:6,courage:4,armor:2,attackValue:6,defenceValue:5,shootValue:6,shootRange:18,movement:8,strengthPoints:5},freeActivations:["move"],rules:["Firefight","Go To Ground"],options:{"Armor-Piercing":_["Armor-Piercing"],"Assault Doctrine":_["Assault Doctrine"],"Close Quarters Doctrine":_["Close Quarters Doctrine"],"Fire Support":_["Fire Support"],Guerrillas:_.Guerrillas,"Heavy Weapon":_["Heavy Weapon"],"Increased Squad Size":{name:"Increased Squad Size",points:2,description:'This unit begins the game with 10 Strength Points and increases its Attack Value to 5+, Defence Value to 4+ and Shoot Value to 5+/18".',short:'10 Strength Points, Attack Value 5+, Defence Value 4+, Shoot Value 5+/18".',setStats:{attackValue:5,defenceValue:4,shootValue:5,shootRange:18,strengthPoints:10}},Mobile:_.Mobile,Undisciplined:_.Undisciplined},xenosRules:[]},"Berserk Infantry":{name:"Berserk Infantry",type:"foot",points:2,stats:{attack:5,move:6,shoot:7,courage:4,armor:2,attackValue:4,defenceValue:6,shootValue:6,shootRange:12,movement:8,strengthPoints:5},freeActivations:["move"],rules:["Counter-Charge","Firefight","Open Order","Ranger","Wild Charge"],options:{Demolitions:_.Demolitions,"Enthusiastic But Untrained":{name:"Enthusiastic But Untrained",points:-1,description:"This unit's Attack Value is reduced by 1 (e.g. 4+ to 5+ for base units).",short:"Attack Value -1.",adjustStats:{attackValue:1}},"Heavy Armor":{name:"Heavy Armor",points:2,description:"This unit's armor becomes 3.",short:"Armor becomes 3.",setStats:{armor:3},disabledBy:["Even Heavier armor"]},"Even Heavier armor":{name:"Even Heavier armor",points:4,description:"Change this unit's armor to 4 and Attack Value to 3+. May not be combined with Heavy armor or Increased Squad Size.",short:"Armor 4, Attack Value 3+.",setStats:{armor:4,attackValue:3},disabledBy:["Increased Squad Size","Heavy Armor"]},"High-Powered Blades":_["High-Powered Blades"],"Increased Squad Size":{name:"Increased Squad Size",points:1,description:"This unit begins the game with 10 Strength Points, and also increases its Attack Value to 3+. This unit's Defence Value and Shoot Value remain unchanged.",short:"10 Strength Points, Attack Value 3+.",setStats:{attackValue:3,strengthPoints:10},disabledBy:["Even Heavier armor"]},Mobile:_.Mobile,Veteran:{name:"Veteran",points:2,description:"This unit's Defence Value becomes 5+.",short:"Defence Value 5+.",setStats:{defenceValue:5}}},xenosRules:[]},"Support Infantry":{name:"Support Infantry",type:"foot",points:5,stats:{attack:0,move:6,shoot:7,courage:4,armor:2,attackValue:0,defenceValue:5,shootValue:4,shootRange:24,movement:6,strengthPoints:5},freeActivations:["shoot"],rules:["Firefight","Spotters","Never Attacks"],options:{"Anti-Tank":_["Anti-Tank"],"Armor-Piercing":_["Armor-Piercing"],Artillery:{name:"Artillery",points:2,description:`This unit's Shooting Range becomes 48". Cannot be combined with Close Quarters Doctrine.`,short:'Shooting Range 48".',setStats:{shootValue:4,shootRange:48},disabledBy:["Close Quarters Doctrine"]},"Close Quarters Doctrine":{..._["Close Quarters Doctrine"],points:-2},Engulfing:_.Engulfing,"Heavy Weapon":_["Heavy Weapon"],"Indirect Fire":_["Indirect Fire"]},xenosRules:[]},"Recon Infantry":{name:"Recon Infantry",type:"foot",points:2,stats:{attack:7,move:5,shoot:7,courage:5,armor:1,attackValue:6,defenceValue:6,shootValue:5,shootRange:12,movement:8,strengthPoints:5},freeActivations:[],rules:["Firefight","Hard to Target","Open Order","Skirmish"],options:{"Counter-Sniper Training":_["Counter-Sniper Training"],"Fire Support":_["Fire Support"],"Green Recons":_["Green Recons"],"Sniper Team":_["Sniper Team"],"Veteran Recons":_["Veteran Recons"]},xenosRules:[]},"Primitive Infantry":{name:"Primitive Infantry",type:"foot",points:1,stats:{attack:5,move:6,shoot:0,courage:4,armor:1,attackValue:5,defenceValue:6,shootValue:0,shootRange:0,movement:8,strengthPoints:5},freeActivations:["move"],rules:["Go To Ground","Open Order"],options:{Armored:_.Armored,"Increased Squad Size":{name:"Increased Squad Size",points:1,description:"This unit begins the game with 10 Strength Points and increases its Attack Value to 4+, Defence Value to 5+. Its Shoot Value remains unchanged. This cannot be combined with Mob.",short:"10 Strength Points, Attack Value 4+, Defence Value 5+.",setStats:{attackValue:4,defenceValue:5,strengthPoints:10},disabledBy:["Mob"]},Mob:{name:"Mob",points:2,description:"This unit begins the game with 15 Strength Points, and also increases its Attack Value to 3+ and its Defence Value to 5+. Its Shoot Value remains unchanged. This cannot be combined with Increased Squad Size.",short:"15 Strength Points, Attack Value 3+, Defence Value 5+.",setStats:{attackValue:3,defenceValue:5,strengthPoints:15},disabledBy:["Increased Squad Size"]},Mobile:_.Mobile,"Primitive Missiles":_["Primitive Missiles"],Savages:{name:"Savages",points:-1,description:"This unit becomes subject to the rules for Wild Charges. Cannot be combined with Primitive Missiles.",short:"Gets Wild Charges.",add:["Wild Charge"],disabledBy:["Primitive Missiles"]},"Young Warriors":{name:"Young Warriors",points:-1,description:"Courage becomes 5+.",short:"Courage 5+.",setStats:{courage:5}}},xenosRules:[]},"Militia Rabble":{name:"Militia Rabble",type:"foot",points:1,stats:{attack:8,move:6,shoot:7,courage:5,armor:1,attackValue:6,defenceValue:6,shootValue:6,shootRange:6,movement:6,strengthPoints:10},freeActivations:[],rules:[],options:{Mob:{name:"Mob",points:1,description:`This unit begins the game with 15 Strength Points, and also increases Shoot Value to 6 / 12". This unit's Attack Value and Defence Value remain unchanged.`,short:'15 Strength Points, Shoot Value 6 / 12".',setStats:{shootValue:6,shootRange:12,strengthPoints:15}},"Ravenous Horde":{name:"Ravenous Horde",points:0,description:" Remove this unit's Shoot and Shoot Value, but increase its Attack to a (still-pathetic) 7+.",short:"Remove shooting. Attack 7+.",setStats:{attack:7,shoot:0,shootValue:0,shootRange:0}}},xenosRules:[]},"Greater Xenomorphs":{name:"Greater Xenomorphs",type:"foot",points:4,stats:{attack:5,move:6,shoot:0,courage:3,armor:4,attackValue:3,defenceValue:6,shootValue:0,shootRange:0,movement:10,strengthPoints:5},freeActivations:["move"],rules:["Open Order","Ranger","Wild Charge"],options:{Cunning:{name:"Cunning",points:2,description:"This unit's Defence Value becomes 5+.",short:"Defence Value 5+.",setStats:{defenceValue:5}},Ponderous:{name:"Ponderous",points:1,description:"This unit loses the Wild Charge rule.",short:"Loses Wild Charge.",remove:["Wild Charge"],disabledBy:["Xenomorph Ranged Attack"]},Demolitions:_.Demolitions,"High-Powered Blades":_["High-Powered Blades"],"Xenomorph Ranged Attack":{name:"Xenomorph Ranged Attack",points:2,description:'This unit either has a ranged weapon or can spit acid, flame or poison gas. Remove the Wild Charge rule and replace it with Shoot 6+ and Shoot Value 5+ / 18".',short:'Remove Wild Charge, Shoot 6+, Shoot Value 5+/18".',setStats:{shoot:6,shootValue:5,shootRange:18},remove:["Wild Charge"],disabledBy:["Ponderous"]},"Anti-Tank":{..._["Anti-Tank"],enabledBy:["Xenomorph Ranged Attack"]},"Area Effect":{..._["Area Effect"],enabledBy:["Xenomorph Ranged Attack"]},"Armor-Piercing":{..._["Armor-Piercing"],enabledBy:["Xenomorph Ranged Attack"]},"Close Quarters Doctrine":{..._["Close Quarters Doctrine"],enabledBy:["Xenomorph Ranged Attack"]}},xenosRules:[]},"Lesser Xenomorphs":{name:"Lesser Xenomorphs",type:"foot",points:2,stats:{attack:5,move:6,shoot:0,courage:4,armor:3,attackValue:4,defenceValue:6,shootValue:0,shootRange:0,movement:12,strengthPoints:5},freeActivations:["move"],rules:["Open Order","Ranger","Wild Charge"],options:{Cunning:{name:"Cunning",points:2,description:"This unit's Defence Value becomes 5+.",short:"Defence Value 5+.",setStats:{defenceValue:5}},"High-Powered Blades":_["High-Powered Blades"],Swarm:{name:"Swarm",points:2,description:"This unit begins the game with 10 Strength Points, and also increases its Attack Value to 3+. Its Defence Value and Shoot Value remain unchanged.",short:"10 Strength Points, Attack Value 3+.",setStats:{attackValue:3}},"Xenomorph Ranged Attack":{name:"Xenomorph Ranged Attack",points:2,description:'This unit either has a ranged weapon or can spit acid, flame or poison gas. Remove the Wild Charge rule and replace it with Shoot 6+ and Shoot Value 5+ / 18".',short:'Remove Wild Charge, Shoot 6+, Shoot Value 5+/18".',setStats:{shoot:6,shootValue:5,shootRange:18},remove:["Wild Charge"]},"Anti-Tank":{..._["Anti-Tank"],enabledBy:["Xenomorph Ranged Attack"]},"Area Effect":{..._["Area Effect"],enabledBy:["Xenomorph Ranged Attack"]},"Armor-Piercing":{..._["Armor-Piercing"],enabledBy:["Xenomorph Ranged Attack"]},"Close Quarters Doctrine":{..._["Close Quarters Doctrine"],enabledBy:["Xenomorph Ranged Attack"]}},xenosRules:[]},"Fighting Vehicle":{name:"Fighting Vehicle",type:"vehicle",points:6,stats:{attack:6,move:6,shoot:6,courage:3,armor:6,attackValue:6,defenceValue:5,shootValue:4,shootRange:18,movement:8,strengthPoints:5},freeActivations:["move"],rules:["All-Terrain","Anti-Tank","Demolitions","High-Powered Blades","Line-Breaker","Vehicle"],options:{"Anti-Personnel Specialism":{name:"Anti-Personnel Specialism",points:-1,description:"This unit is geared almost exclusively towards blowing up or mowing down infantry. Remove the Anti-Tank rule.",short:"Remove Anti-Tank.",remove:["Anti-Tank"]},"Area Effect":_["Area Effect"],"Armor-Piercing":_["Armor-Piercing"],Artillery:_.Artillery,"Close Quarters Doctrine":_["Close Quarters Doctrine"],"Combat Engineering Vehicle":_["Combat Engineering Vehicle"],"Indirect Fire":_["Indirect Fire"],"Light armored Vehicle":{name:"Light armored Vehicle",points:-2,description:"Reduce this unit's armor by 1 and remove the Demolitions and Line-Breaker rules.",short:"Armor -1, remove Demolitions and Line-Breaker.",adjustStats:{armor:-1},remove:["Demolitions","Line-Breaker"]},"Green Crew":{name:"Green Crew",points:-1,description:`This unit's Shoot Value becomes 5+ / 18" (5+ / 12" with Close Quarters Doctrine, 5+ / 48" with Artillery). This cannot be combined with Veteran Crew.`,short:'Shoot Value 5+ / 18".',setStats:{shootValue:5},disabledBy:["Veteran Crew"]},"Veteran Crew":_["Veteran Crew"],Walker:_.Walker},xenosRules:[]},"Transport Vehicle":{name:"Transport Vehicle",type:"vehicle",points:4,stats:{attack:6,move:6,shoot:6,courage:4,armor:5,attackValue:6,defenceValue:6,shootValue:5,shootRange:12,movement:10,strengthPoints:5},freeActivations:["move"],rules:["High-Powered Blades","Transport (5)","Vehicle"],options:{"All-Terrain":_["All-Terrain"],"Armor-Piercing":_["Armor-Piercing"],"Line-Breaker":{name:"Line-Breaker",points:2,description:"This unit is not slowed by linear obstacles such as barricades, barbed wire, low walls, fences or trench parapets. In the case of obstacles that could plausibly be crushed beneath the vehicle, you can remove an appropriately sized stretch of the obstacle after the unit passes over it.",short:"Can move through linear obstacles.",add:["Line-Breaker"]},"Transport (10)":{name:"Transport (10)",points:1,description:"This vehicle can carry an infantry unit with up to 10 Strength Points. This replaces Transport (5).",remove:["Transport (5)"],add:["Transport (10)"]},"Green Crew":{name:"Green Crew",points:-1,description:`This vehicle's Shoot Value becomes 6 / 12"`,short:'Shoot Value 6 / 12".',setStats:{shootValue:6}},Walker:{..._.Walker,setStats:{attackValue:4,defenceValue:5}},Demolitions:_.Demolitions},xenosRules:[]},"Soft-Skin Vehicle":{name:"Soft-Skin Vehicle",type:"vehicle",points:2,stats:{attack:6,move:6,shoot:7,courage:4,armor:3,attackValue:6,defenceValue:6,shootValue:6,shootRange:6,movement:12,strengthPoints:5},freeActivations:["move"],rules:["Vehicle"],options:{"All-Terrain":_["All-Terrain"],Civilian:{name:"Civilian",points:-1,description:"This unit is a civilian vehicle, lacking in any armor. Reduce its Armor to 2. Cannot be combined with Improvised Armour.",short:"Armor 2.",setStats:{armor:2},disabledBy:["Improvised Armour"]},"Improvised Armour":{name:"Improvised Armour",points:1,description:"Heavy armor plating has been welded onto this vehicle, slowing its Maximum Movement by 2”, but increasing its Armor to 4.",short:"Movement -2”, Armor 4.",setStats:{armor:4},adjustStats:{movement:-2},disabledBy:["Civilian"]},"Large Vehicle":{name:"Large Vehicle ",points:2,description:'This vehicle is a bus, oil tanker, combine harvester, or similarly bulky vehicle. Reduce its Maximum Movement by 2", but increase Strength Points to 10.',short:"Strength Points 10, Movement -2”.",setStats:{strengthPoints:10},adjustStats:{movement:-2}},"Green Crew":{name:"Green Crew",points:-1,description:"This unit's Courage becomes 5+.",short:"Courage 5+.",setStats:{courage:5}},Scythes:{name:"Scythes",points:1,description:"Scythed wheels, spiked dozer blades, or meat hooks trailing on chains increases this unit's Attack Value to 5+.",short:"Attack Value 5+.",setStats:{attackValue:5}},"Transport (5)":{name:"Transport (5)",points:1,description:"This vehicle can carry an infantry unit with up to 5 Strength Points.",add:["Transport (5)"]},"Transport (10)":{name:"Transport (10)",points:2,description:"This vehicle can carry an infantry unit with up to 10 Strength Points.",add:["Transport (10)"]},"Transport (15)":{name:"Transport (15)",points:2,description:"This vehicle can carry an infantry unit with up to 15 Strength Points.",adjustStats:{movement:-2},add:["Transport (15)"]},Walker:{..._.Walker,setStats:{attackValue:4,defenceValue:5}},Demolitions:{..._.Demolitions,enabledBy:["Walker"]},"High-Powered Blades":{..._["High-Powered Blades"],enabledBy:["Walker"]},Technical:{name:"Technical",points:2,description:'This vehicle has weapons, possibly hastily bolted onto the chassis. Improve its Shoot to 6+ and Shoot Value to 5+ / 18".',short:'Shoot 6+, Shoot Value 5+/18".',setStats:{shoot:6,shootValue:5,shootRange:18}},"Anti-Tank":{..._["Anti-Tank"],enabledBy:["Technical"]},"Armor-Piercing":{..._["Armor-Piercing"],enabledBy:["Technical"]},"Close Quarters Doctrine":{..._["Close Quarters Doctrine"],enabledBy:["Technical"]},Engulfing:{..._.Engulfing,enabledBy:["Technical"]}},xenosRules:[]}},Si={Commander:{name:"Commander",points:0,exclude_units:[],description:'The Commander grants a +1 modifier to all ordered activations and Courage tests taken by units within 12" of its unit, including the Commander’s own unit. These bonuses only apply if the Commander is not Suppressed.',short:'Grants a +1 modifier to all ordered activations and Courage tests taken within 12".'},"Boarding Shields":{name:"Boarding Shields",points:2,exclude_units:["Militia Rabble"],description:"Troops armed with Boarding Shields improve their Defence Value characteristic by 1 (e.g. from 4+ to 3+), and also gain +1 Armour against Shoot actions and Firefight reactions.",short:"Defense value increased by 1, armor +1 vs shooting.",adjustStats:{defenceValue:-1}},"Brutal Leader":{name:"Brutal Leader",points:2,exclude_units:["Militia Rabble"],description:'This unit, plus any other friendly units within 6", may re-roll failed Courage tests (including for Rallying), once per test. This effect only applies if the Brutal Leader’s unit is not Suppressed (therefore this rule cannot be used to Rally the Brutal Leader’s own unit). A unit re-rolling a test because of a Brutal Leader will automatically lose a Strength Point. This Strength Point loss is in addition to any caused by failed Courage tests and does not cause further Courage tests.',short:'Unit on 6" re-roll courage, but loses 1 strength point.'},"Cloaking Device":{name:"Cloaking Device",points:3,exclude_units:["Militia Rabble","Recon Infantry"],description:'The unit may only be targeted by ranged attacks within 12" and gains +1 Armour against Shoot actions and Firefight reactions. Psychic powers and Attacks work as normal against cloaked units.',short:'Can only be target in 12" and +1 armor vs shooting.'},"Combat Medic":{name:"Combat Medic",points:2,exclude_units:["Militia Rabble"],description:'Should the unit, or a friendly one within 6", lose Strength Points (except as the result of a failed Courage test or the Brutal Leader xeno rule), roll one die. Subtract 1 from the result if the unit with Combat Medic is at half Strength Points or below. On a roll of 4+, reduce the number of Strength Points lost by one. Combat Medic has no effect on units with the Demonic, Mechanoid, or Undead xeno rules (unless the unit with Combat Medic also has the matching xeno rule), and cannot be used when the unit with Combat Medic is Suppressed.',short:'On a 4+ (-1 if under half strength) a unit within 6" looses 1 less strength points.'},Contagious:{name:"Contagious",points:1,exclude_units:[],description:"Demonic or Undead infantry units only. Every time this unit inflicts Strength Point loss on an enemy infantry unit during an Attack (whether Attacking or Defending), the Contagious unit regains one Strength Point that it has lost during the game.",short:"Regain a strength point for each strength point inflicted in close combat."},Crusader:{name:"Crusader",points:4,exclude_units:["Militia Rabble","Recon Infantry","Berserk Infantry","Soft-skin Vehicle"],description:"Pick a target for the Crusader’s wrath: units with the Demonic, Mechanoid, or Undead xeno rule, or a particular species of alien (including, for aliens, humans), are all applicable choices. Followers of another religion, so long as that would be obvious on the battlefield such as in a war between two cults, is also a possibility. A Crusader unit may re-roll all misses once during Shooting and Attacks, including in Firefights and while Defending, when fighting against a unit of the targeted type. A Crusader may choose to ignore the effects caused by Fearsome units of the targeted type. The 4-point cost only applies when playing against a Detachment with one or more units of the targeted type present.",short:"Re-roll all misses once during Shooting and close combat when fighting against a unit of the targeted type."},"Crusader 0":{name:"Crusader 0",points:0,exclude_units:["Militia Rabble","Recon Infantry","Berserk Infantry","Soft-skin Vehicle"],description:"Pick a target for the Crusader’s wrath: units with the Demonic, Mechanoid, or Undead xeno rule, or a particular species of alien (including, for aliens, humans), are all applicable choices. Followers of another religion, so long as that would be obvious on the battlefield such as in a war between two cults, is also a possibility. A Crusader unit may re-roll all misses once during Shooting and Attacks, including in Firefights and while Defending, when fighting against a unit of the targeted type. A Crusader may choose to ignore the effects caused by Fearsome units of the targeted type. The 0-point cost only applies when playing against a Detachment with none of the targeted type present.",short:"Re-roll all misses once during Shooting and close combat when fighting against a unit of the targeted type."},Demonic:{name:"Demonic",points:0,exclude_units:[],description:"Demonic units have the following additional rules: Ignore the effects of Stun Weapons. Ignore the effects of Fearsome units. Count as having the Fearsome xeno rule, at no extra cost. Enemies who target Demonic units with psychic powers gain a +2 modifier to their  activation roll. Any Strength Point loss inflicted on other Demonic units is doubled. A Demonic unit that has lost any of its starting Strength Points counts as having the Unstable xeno rule."},"Exploder 1":{name:"Exploder 1",points:1,exclude_units:["Militia Rabble","Recon Infantry"],description:'The unit acts as normal until it explodes. Units with the 1-point version of this xeno rule will explode upon reaching 0 Strength Points, but before any models are removed from the table. Removal from the table by any other means (such as routing) means that the unit does not explode. When the unit explodes, the explosion affects all buildings and units – friend and foe alike – within a 6" radius of the exploding unit. This works as a Shoot action hitting on a 3+ (the number of dice rolled is equal to the Exploder’s Strength Points immediately prior to the action triggering the explosion), but you should roll separately for each unit within the blast zone. Once exploded, the Exploder unit is removed the table and counts as destroyed.',short:'Explode upon reaching 0 Strength Points. 3+ Shooting attack against all units within 6"'},"Exploder 2":{name:"Exploder 2",points:2,exclude_units:["Militia Rabble","Recon Infantry"],description:'The unit acts as normal until it explodes. Units with the 2-point version only explode by choice, as an ordered activation successful on a 5+. A failed activation test means that only a partial detonation occurs, destroying the unit but without harming anyone else. Remove the unit from play as a casualty. When the unit explodes, the explosion affects all buildings and units – friend and foe alike – within a 6" radius of the exploding unit. This works as a Shoot action hitting on a 3+ (the number of dice rolled is equal to the Exploder’s Strength Points immediately prior to the action triggering the explosion), but you should roll separately for each unit within the blast zone. Once exploded, the Exploder unit is removed the table and counts as destroyed.',short:'Explode upon an ordered 5+ activation. 3+ Shooting attack against all units within 6"'},"Fanatical Discipline":{name:"Fanatical Discipline",points:2,exclude_units:["Militia Rabble"],description:"This unit is courageous to the point of foolhardiness. Improve its Courage score by 1, to a maximum of 3+. For example, a unit with Courage 5+ becomes Courage 4+.",short:"Courage +1.",adjustStats:{courage:-1}},Fearsome:{name:"Fearsome",points:2,exclude_units:[],description:"Courage tests caused as the result of an Attack (but not Shooting) by a Fearsome unit suffer an additional -1 to the total. Fearsome does not apply when the Fearsome unit is the Defender. Demonic, Mechanoid, and Undead units, and those with the Fearsome xeno rule themselves, are not frightened of Fearsome opponents.",short:"On attack: Enemy courage tests -1."},Fearful:{name:"Fearful",points:-1,exclude_units:["Militia Rabble"],description:"Decreases this units courage by one.",short:"Courage -1.",adjustStats:{courage:1}},Flying:{name:"Flying",points:2,exclude_units:["Militia Rabble"],description:'A Flying unit may move over friends and enemies during its movement, but at the end of its move must adhere to the 1" proximity rule just like any other unit. Line of sight can be drawn to or from Flying units from anywhere on the tabletop, except where that passes through the roofs of buildings, forest canopies, or other forms of overhead cover; assume Flying units are positioned well above the table. Flying units can always draw line of sight to other Flying units.Flying units ignore all terrain for Moving and Attacking, and they never benefit from cover. Units targeted by a Flying unit will only benefit from cover if it is a building, woods, or some other overhead cover. Flying units cannot be Attacked by units that do not also possess the Flying xeno rule, but can be targeted by Shooting. When Retreating, a Flying unit moves its full Maximum Movement.'},"Force field 1":{name:"Force field 1",points:1,exclude_units:["Militia Rabble"],description:"When the unit loses Strength Points to Shooting (but not during Attacks), roll a die for each lost Strength Point. For each 6 rolled, reduce the number of Strength Points lost by one.",short:"Strength Points losses to Shooting can be saved by 6+."},"Force field 2":{name:"Force field 2",points:2,exclude_units:["Militia Rabble"],description:"When the unit loses Strength Points to Shooting (but not during Attacks), roll a die for each lost Strength Point. For each 5 or 6 rolled, reduce the number of Strength Points lost by one.",short:"Strength Points losses to Shooting can be saved by 5+."},"Force field 3":{name:"Force field 3",points:3,exclude_units:["Militia Rabble"],description:"When the unit loses Strength Points to Shooting or during Attacks, roll a die for each lost Strength Point. For each 5 or 6 rolled, reduce the number of Strength Points lost by one.",short:"Strength Points losses can be saved by 5+."},Hatred:{name:"Hatred",points:1,exclude_units:[],description:"Before deployment, pick a target for your unit’s Hatred. Units with Hatred gain the Wild Charge special rule against enemy units they hate. Units with Hatred that already have the Wild Charge special rule automatically pass their Wild Charge tests against enemy units they hate.",short:"Pick a target for your unit’s Hatred. Gain Wild Charge against the target."},"Hive Mind":{name:"Hive Mind",points:1,exclude_units:["Militia Rabble"],description:'While the Detachment’s Commander is on the table and not Suppressed, all friendly units that have the Hive Mind xeno rule are counted as if they were within 12" of the Commander model. If a unit with the Hive Mind rule is actually within 12" of the Commander model, they also count as being Courage 0+. A Commander unit may not take this xeno rule.',short:'Always count as if within 12" of the Commander. If within 12" Courage 0+.'},Immobile:{name:"Immobile",points:-2,exclude_units:["Militia Rabble"],description:"As Immobile units cannot take Move actions, they cannot board or disembark a transport vehicle. Immobile units cannot move onto the table after the start of Turn 1, unless they also have the Special Insertion xeno rule to enter play.",short:"Cannot take Move actions."},Infiltrators:{name:"Infiltrators",points:1,exclude_units:["Militia Rabble"],description:"After deployment, but prior to the start of the game, each unit of Infiltrators may make a single Move activation. This Move action does not require an activation test and you may roll a die and increase the number of inches each unit can move by the result. A unit of Infiltrators cannot use its pre-game Move action to embark or disembark from a vehicle. If both players have Infiltrators, the attacker should move all of their Infiltrators first.",short:"After deployment make a single Move activation with +d6 movement."},"Inspirational Leader":{name:"Inspirational Leader",points:2,exclude_units:["Militia Rabble"],description:"This unit, plus any other friendly units within 6”, may re-roll failed Courage tests (including Rallying), once per test. This effect only applies if the Inspirational Leader’s unit is not Suppressed.",short:"Units within 6”, may re-roll failed Courage tests."},Mechanoid:{name:"Mechanoid",points:0,exclude_units:[],description:"Ignore the effects of Stun Weapons. Each unit may have an additional Free Action from the following: Attack, Move or Shoot. However, they suffer a -1 modifier to any ordered activation tests. Mechanoids never take Courage tests, and so never become Suppressed or forced to rout. Mechanoid units at half Strength Points or below lose all their Free Actions; such actions then count as ordered activations. Furthermore, a Mechanoid unit at half Strength Points or below that rolls a double on a failed activation roll suffers a critical system failure and undergoes emergency shutdown; immediately counting as destroyed."},Mercenary:{name:"Mercenary",points:-1,exclude_units:["Militia Rabble"],description:"See rulebook."},"Mono-Molecular Blades":{name:"Mono-Molecular Blades",points:2,exclude_units:["Militia Rabble"],description:"When fighting during Attacks, whether as Attacker or Defender, any 6s rolled by this unit count as two hits, rather than the usual one.",short:"During close combat any 6s rolled count as two hits."},Regeneration:{name:"Regeneration",points:1,exclude_units:["Militia Rabble"],description:"As an ordered activation, succeeding on a 7+, this unit can restore 1 Strength Point it has previously lost, for any reason, during the game. This cannot take the unit above its initial Strength Point total.",short:"As an ordered 7+ activation restore 1 Strength Point."},Skimmer:{name:"Skimmer",points:1,exclude_units:["Militia Rabble"],description:"When it moves, including during Retreats and Attacks, the unit can ignore rough and impassable terrain, gliding straight over it. The unit may not end its move in  impassable terrain.",short:"Can ignore rough and impassable terrain."},Slow:{name:"Slow",points:-1,exclude_units:["Militia Rabble"],description:'Reduce the units Maximum Movement value by 2". This cannot be combined with the Mobile option available to some units.',short:'Movement -2".',adjustStats:{movement:-2}},"Special Insertion":{name:"Special Insertion",points:1,exclude_units:[],description:'Special Insertion units begin the game in reserve and are not deployed with the rest of your Detachment. They deploy in one of two ways: 1. A Psychic unit that successfully Manifests the Summoner psychic power can place a single Special Insertion unit anywhere within 12" of themselves, but at least 6" away from any enemy units. 2. A Special Insertion unit can be activated while off the table, but it can only make an ordered Move activation (even if Move is normally a Free Action for it). If successful, place the unit anywhere on the table, so long as it is not within 6” of an enemy unit. If unsuccessful, the unit can still be placed on the table, but if you do, you must roll a die and compare it to the unit’s Courage; if you roll below the unit’s Courage, it suffers the die result in Strength Point damage, which causes an immediate Courage test. You can choose not to deploy a Special Insertion unit on a failed activation test and not have it suffer any Strength Point damage',short:"Can be teleported on the battle field."},"Stabilised Weaponry":{name:"Stabilised Weaponry",points:2,exclude_units:["Militia Rabble"],description:"Infantry only. Units with Stabilised Weaponry can Move and Shoot as an ordered activation in the same way as vehicles.",short:"Can Move and Shoot as an ordered activation."},"Stun Weapons":{name:"Stun Weapons",points:1,exclude_units:[],description:"This xeno rule applies to both a unit’s Attack and Shoot actions. Hits from Stun Weapons are treated as normal, but do not cause Strength Point loss. Instead, any ‘casualties’ that would have been inflicted count as double for the purposes of Courage tests. Before any dice are rolled for a given Attack or Shoot action, a unit with Stun Weapons may choose to use lethal force if it prefers. Demonic, Mechanoid, and Undead units are immune to the effects of Stun Weapons.",short:'Hits from Stun Weapons do not cause Strength Point loss. Each "loss" counts double for courage tests.'},"Teleport Jump":{name:"Teleport Jump",points:1,exclude_units:["Militia Rabble"],description:"When this unit takes a Move action, it can either choose to move normally, or it can teleport. If it chooses to teleport, choose the desired direction and then roll two dice; you may move the unit any number of inches up to the result. You do not have to move the full distance but may ignore all terrain effects (including impassable terrain). If the distance rolled on the two dice is a double, the unit still moves as above, but something has gone horribly wrong during teleportation; the unit loses a number of Strength Points equal to the result of one of the dice.",short:"Unit may move 2d6 in any direction. On a double loose strangth points."},Unarmed:{name:"Unarmed",points:-1,exclude_units:["Militia Rabble"],description:'Whatever the reason, the Unarmed xeno rule changes a unit’s Shoot and Shoot Value characteristics to "-". Only units that normally have a ranged attack can take this xeno rule.',short:'Shoot and Shoot Value become "-".',setStats:{shoot:0,shootValue:0,shootRange:0}},Undead:{name:"Undead",points:0,exclude_units:[],description:"Ignore the effects of Fearsome units. Ignore the effects of Stun Weapons. Courage value of 0+. This means that your unit will never become Suppressed, but will still rout on a negative Courage Test result as enough of the unit take crippling injuries that they cease to be combat effective or the force reanimating them dissipates. Any excess hits they take during Attacks are rounded up when working out how many Strength Points are lost. Shooting is resolved normally."},Unstable:{name:"Unarmed",points:-2,exclude_units:["Militia Rabble"],description:"If this unit rolls a double on an activation roll, including for ‘out-of-sequence’ activations like Wild Charge or Firefight tests, but excluding Rally tests, the order passes or fails as normal, but the unit loses a number of Strength Points equal to the result of one of the dice.",short:"On a double on an activation roll, lose Strength Points equal to one of the dice."},"Psychic 1":{name:"Psychic 1",points:1,exclude_units:["Militia Rabble","Berserk Infantry","Soft-skin Vehicle"],description:"The unit has access to one psychic power."},"Psychic 2":{name:"Psychic 2",points:2,exclude_units:["Militia Rabble","Berserk Infantry","Soft-skin Vehicle"],description:"The unit has access to two psychic powers."},"Psychic 3":{name:"Psychic 3",points:3,exclude_units:["Militia Rabble","Berserk Infantry","Soft-skin Vehicle"],description:"The unit has access to three psychic powers."},"Psychic 4":{name:"Psychic 4",points:4,exclude_units:["Militia Rabble","Berserk Infantry","Soft-skin Vehicle"],description:'The unit has access to three psychic powers and increases the range of all powers by 6".'},"Psychic Hazards":{name:"Psychic Hazards",points:-1,exclude_units:["Militia Rabble","Berserk Infantry","Soft-skin Vehicle"],description:"Psychic units only. A unit with the Psychic Hazards xeno rule will suffer Strength Point loss if it rolls a double on an activation test to Manifest a psychic power. If the activation test is successful, the power is still Manifested, although should the Manifesting unit be Suppressed or destroyed by the loss of Strength Points, any effects of the psychic power will end immediately. The number of Strength Points lost is equal to the number rolled on one of the activation test dice.",short:"On a double on a psychic roll, lose Strength Points equal to one of the dice."},"Psychic Resistance":{name:"Psychic Hazards",points:1,exclude_units:["Militia Rabble"],description:"If this unit is successfully targeted by a psychic power, whether friendly or hostile, roll one die. On a result of 4 or more, the psychic power has no effect. The activation roll used to Manifest the power still counts as a success.",short:"On a 4+ or more, the psychic power has no effect."},"Psychic Species 1":{name:"Psychic Species 1",points:1,exclude_units:["Militia Rabble","Berserk Infantry","Soft-skin Vehicle"],description:"Psychic units only. Psychic powers of Difficulty 6+ can be Manifested as a Free Action.",short:"Psychic powers of Difficulty 6+ can be Manifested as a Free Action."},"Psychic Species 2":{name:"Psychic Species 2",points:2,exclude_units:["Militia Rabble","Berserk Infantry","Soft-skin Vehicle"],description:"Psychic units only. Psychic powers of Difficulty 6+ or 7+ can be Manifested as a Free Action.",short:"Psychic powers of Difficulty 6+ or 7+ can be Manifested as a Free Action."},"Psychic Species 3":{name:"Psychic Species 3",points:3,exclude_units:["Militia Rabble","Berserk Infantry","Soft-skin Vehicle"],description:"Psychic units only. All Psychic powers can be Manifested as a Free Action.",short:"All Psychic powers can be Manifested as a Free Action."}};function dt(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var zt={},wi={get exports(){return zt},set exports(t){zt=t}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(t,n){(function(a){t.exports=a()})(function(){return function a(r,o,s){function h(f,v){if(!o[f]){if(!r[f]){var y=typeof dt=="function"&&dt;if(!v&&y)return y(f,!0);if(c)return c(f,!0);var x=new Error("Cannot find module '"+f+"'");throw x.code="MODULE_NOT_FOUND",x}var R=o[f]={exports:{}};r[f][0].call(R.exports,function(I){var $=r[f][1][I];return h($||I)},R,R.exports,a,r,o,s)}return o[f].exports}for(var c=typeof dt=="function"&&dt,d=0;d<s.length;d++)h(s[d]);return h}({1:[function(a,r,o){(function(s){var h=s.MutationObserver||s.WebKitMutationObserver,c;if(h){var d=0,f=new h(I),v=s.document.createTextNode("");f.observe(v,{characterData:!0}),c=function(){v.data=d=++d%2}}else if(!s.setImmediate&&typeof s.MessageChannel<"u"){var y=new s.MessageChannel;y.port1.onmessage=I,c=function(){y.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?c=function(){var F=s.document.createElement("script");F.onreadystatechange=function(){I(),F.onreadystatechange=null,F.parentNode.removeChild(F),F=null},s.document.documentElement.appendChild(F)}:c=function(){setTimeout(I,0)};var x,R=[];function I(){x=!0;for(var F,Y,P=R.length;P;){for(Y=R,R=[],F=-1;++F<P;)Y[F]();P=R.length}x=!1}r.exports=$;function $(F){R.push(F)===1&&!x&&c()}}).call(this,typeof ke<"u"?ke:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(a,r,o){var s=a(1);function h(){}var c={},d=["REJECTED"],f=["FULFILLED"],v=["PENDING"];r.exports=y;function y(k){if(typeof k!="function")throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,k!==h&&$(this,k)}y.prototype.catch=function(k){return this.then(null,k)},y.prototype.then=function(k,N){if(typeof k!="function"&&this.state===f||typeof N!="function"&&this.state===d)return this;var O=new this.constructor(h);if(this.state!==v){var J=this.state===f?k:N;R(O,J,this.outcome)}else this.queue.push(new x(O,k,N));return O};function x(k,N,O){this.promise=k,typeof N=="function"&&(this.onFulfilled=N,this.callFulfilled=this.otherCallFulfilled),typeof O=="function"&&(this.onRejected=O,this.callRejected=this.otherCallRejected)}x.prototype.callFulfilled=function(k){c.resolve(this.promise,k)},x.prototype.otherCallFulfilled=function(k){R(this.promise,this.onFulfilled,k)},x.prototype.callRejected=function(k){c.reject(this.promise,k)},x.prototype.otherCallRejected=function(k){R(this.promise,this.onRejected,k)};function R(k,N,O){s(function(){var J;try{J=N(O)}catch(ce){return c.reject(k,ce)}J===k?c.reject(k,new TypeError("Cannot resolve promise with itself")):c.resolve(k,J)})}c.resolve=function(k,N){var O=F(I,N);if(O.status==="error")return c.reject(k,O.value);var J=O.value;if(J)$(k,J);else{k.state=f,k.outcome=N;for(var ce=-1,pe=k.queue.length;++ce<pe;)k.queue[ce].callFulfilled(N)}return k},c.reject=function(k,N){k.state=d,k.outcome=N;for(var O=-1,J=k.queue.length;++O<J;)k.queue[O].callRejected(N);return k};function I(k){var N=k&&k.then;if(k&&(typeof k=="object"||typeof k=="function")&&typeof N=="function")return function(){N.apply(k,arguments)}}function $(k,N){var O=!1;function J(ye){O||(O=!0,c.reject(k,ye))}function ce(ye){O||(O=!0,c.resolve(k,ye))}function pe(){N(ce,J)}var ve=F(pe);ve.status==="error"&&J(ve.value)}function F(k,N){var O={};try{O.value=k(N),O.status="success"}catch(J){O.status="error",O.value=J}return O}y.resolve=Y;function Y(k){return k instanceof this?k:c.resolve(new this(h),k)}y.reject=P;function P(k){var N=new this(h);return c.reject(N,k)}y.all=Z;function Z(k){var N=this;if(Object.prototype.toString.call(k)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=k.length,J=!1;if(!O)return this.resolve([]);for(var ce=new Array(O),pe=0,ve=-1,ye=new this(h);++ve<O;)Re(k[ve],ve);return ye;function Re(Xe,st){N.resolve(Xe).then(Tt,function(We){J||(J=!0,c.reject(ye,We))});function Tt(We){ce[st]=We,++pe===O&&!J&&(J=!0,c.resolve(ye,ce))}}}y.race=se;function se(k){var N=this;if(Object.prototype.toString.call(k)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=k.length,J=!1;if(!O)return this.resolve([]);for(var ce=-1,pe=new this(h);++ce<O;)ve(k[ce]);return pe;function ve(ye){N.resolve(ye).then(function(Re){J||(J=!0,c.resolve(pe,Re))},function(Re){J||(J=!0,c.reject(pe,Re))})}}},{1:1}],3:[function(a,r,o){(function(s){typeof s.Promise!="function"&&(s.Promise=a(2))}).call(this,typeof ke<"u"?ke:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(a,r,o){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i};function h(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")}function c(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var d=c();function f(){try{if(!d||!d.open)return!1;var i=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),u=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!i||u)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function v(i,u){i=i||[],u=u||{};try{return new Blob(i,u)}catch(m){if(m.name!=="TypeError")throw m;for(var l=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,p=new l,g=0;g<i.length;g+=1)p.append(i[g]);return p.getBlob(u.type)}}typeof Promise>"u"&&a(3);var y=Promise;function x(i,u){u&&i.then(function(l){u(null,l)},function(l){u(l)})}function R(i,u,l){typeof u=="function"&&i.then(u),typeof l=="function"&&i.catch(l)}function I(i){return typeof i!="string"&&(console.warn(i+" used as a key, but it is not a string."),i=String(i)),i}function $(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var F="local-forage-detect-blob-support",Y=void 0,P={},Z=Object.prototype.toString,se="readonly",k="readwrite";function N(i){for(var u=i.length,l=new ArrayBuffer(u),p=new Uint8Array(l),g=0;g<u;g++)p[g]=i.charCodeAt(g);return l}function O(i){return new y(function(u){var l=i.transaction(F,k),p=v([""]);l.objectStore(F).put(p,"key"),l.onabort=function(g){g.preventDefault(),g.stopPropagation(),u(!1)},l.oncomplete=function(){var g=navigator.userAgent.match(/Chrome\/(\d+)/),m=navigator.userAgent.match(/Edge\//);u(m||!g||parseInt(g[1],10)>=43)}}).catch(function(){return!1})}function J(i){return typeof Y=="boolean"?y.resolve(Y):O(i).then(function(u){return Y=u,Y})}function ce(i){var u=P[i.name],l={};l.promise=new y(function(p,g){l.resolve=p,l.reject=g}),u.deferredOperations.push(l),u.dbReady?u.dbReady=u.dbReady.then(function(){return l.promise}):u.dbReady=l.promise}function pe(i){var u=P[i.name],l=u.deferredOperations.pop();if(l)return l.resolve(),l.promise}function ve(i,u){var l=P[i.name],p=l.deferredOperations.pop();if(p)return p.reject(u),p.promise}function ye(i,u){return new y(function(l,p){if(P[i.name]=P[i.name]||Yn(),i.db)if(u)ce(i),i.db.close();else return l(i.db);var g=[i.name];u&&g.push(i.version);var m=d.open.apply(d,g);u&&(m.onupgradeneeded=function(b){var j=m.result;try{j.createObjectStore(i.storeName),b.oldVersion<=1&&j.createObjectStore(F)}catch(S){if(S.name==="ConstraintError")console.warn('The database "'+i.name+'" has been upgraded from version '+b.oldVersion+" to version "+b.newVersion+', but the storage "'+i.storeName+'" already exists.');else throw S}}),m.onerror=function(b){b.preventDefault(),p(m.error)},m.onsuccess=function(){var b=m.result;b.onversionchange=function(j){j.target.close()},l(b),pe(i)}})}function Re(i){return ye(i,!1)}function Xe(i){return ye(i,!0)}function st(i,u){if(!i.db)return!0;var l=!i.db.objectStoreNames.contains(i.storeName),p=i.version<i.db.version,g=i.version>i.db.version;if(p&&(i.version!==u&&console.warn('The database "'+i.name+`" can't be downgraded from version `+i.db.version+" to version "+i.version+"."),i.version=i.db.version),g||l){if(l){var m=i.db.version+1;m>i.version&&(i.version=m)}return!0}return!1}function Tt(i){return new y(function(u,l){var p=new FileReader;p.onerror=l,p.onloadend=function(g){var m=btoa(g.target.result||"");u({__local_forage_encoded_blob:!0,data:m,type:i.type})},p.readAsBinaryString(i)})}function We(i){var u=N(atob(i.data));return v([u],{type:i.type})}function Gn(i){return i&&i.__local_forage_encoded_blob}function Ia(i){var u=this,l=u._initReady().then(function(){var p=P[u._dbInfo.name];if(p&&p.dbReady)return p.dbReady});return R(l,i,i),l}function Da(i){ce(i);for(var u=P[i.name],l=u.forages,p=0;p<l.length;p++){var g=l[p];g._dbInfo.db&&(g._dbInfo.db.close(),g._dbInfo.db=null)}return i.db=null,Re(i).then(function(m){return i.db=m,st(i)?Xe(i):m}).then(function(m){i.db=u.db=m;for(var b=0;b<l.length;b++)l[b]._dbInfo.db=m}).catch(function(m){throw ve(i,m),m})}function _e(i,u,l,p){p===void 0&&(p=1);try{var g=i.db.transaction(i.storeName,u);l(null,g)}catch(m){if(p>0&&(!i.db||m.name==="InvalidStateError"||m.name==="NotFoundError"))return y.resolve().then(function(){if(!i.db||m.name==="NotFoundError"&&!i.db.objectStoreNames.contains(i.storeName)&&i.version<=i.db.version)return i.db&&(i.version=i.db.version+1),Xe(i)}).then(function(){return Da(i).then(function(){_e(i,u,l,p-1)})}).catch(l);l(m)}}function Yn(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Ma(i){var u=this,l={db:null};if(i)for(var p in i)l[p]=i[p];var g=P[l.name];g||(g=Yn(),P[l.name]=g),g.forages.push(u),u._initReady||(u._initReady=u.ready,u.ready=Ia);var m=[];function b(){return y.resolve()}for(var j=0;j<g.forages.length;j++){var S=g.forages[j];S!==u&&m.push(S._initReady().catch(b))}var w=g.forages.slice(0);return y.all(m).then(function(){return l.db=g.db,Re(l)}).then(function(C){return l.db=C,st(l,u._defaultConfig.version)?Xe(l):C}).then(function(C){l.db=g.db=C,u._dbInfo=l;for(var A=0;A<w.length;A++){var V=w[A];V!==u&&(V._dbInfo.db=l.db,V._dbInfo.version=l.version)}})}function Ea(i,u){var l=this;i=I(i);var p=new y(function(g,m){l.ready().then(function(){_e(l._dbInfo,se,function(b,j){if(b)return m(b);try{var S=j.objectStore(l._dbInfo.storeName),w=S.get(i);w.onsuccess=function(){var C=w.result;C===void 0&&(C=null),Gn(C)&&(C=We(C)),g(C)},w.onerror=function(){m(w.error)}}catch(C){m(C)}})}).catch(m)});return x(p,u),p}function Va(i,u){var l=this,p=new y(function(g,m){l.ready().then(function(){_e(l._dbInfo,se,function(b,j){if(b)return m(b);try{var S=j.objectStore(l._dbInfo.storeName),w=S.openCursor(),C=1;w.onsuccess=function(){var A=w.result;if(A){var V=A.value;Gn(V)&&(V=We(V));var G=i(V,A.key,C++);G!==void 0?g(G):A.continue()}else g()},w.onerror=function(){m(w.error)}}catch(A){m(A)}})}).catch(m)});return x(p,u),p}function Oa(i,u,l){var p=this;i=I(i);var g=new y(function(m,b){var j;p.ready().then(function(){return j=p._dbInfo,Z.call(u)==="[object Blob]"?J(j.db).then(function(S){return S?u:Tt(u)}):u}).then(function(S){_e(p._dbInfo,k,function(w,C){if(w)return b(w);try{var A=C.objectStore(p._dbInfo.storeName);S===null&&(S=void 0);var V=A.put(S,i);C.oncomplete=function(){S===void 0&&(S=null),m(S)},C.onabort=C.onerror=function(){var G=V.error?V.error:V.transaction.error;b(G)}}catch(G){b(G)}})}).catch(b)});return x(g,l),g}function $a(i,u){var l=this;i=I(i);var p=new y(function(g,m){l.ready().then(function(){_e(l._dbInfo,k,function(b,j){if(b)return m(b);try{var S=j.objectStore(l._dbInfo.storeName),w=S.delete(i);j.oncomplete=function(){g()},j.onerror=function(){m(w.error)},j.onabort=function(){var C=w.error?w.error:w.transaction.error;m(C)}}catch(C){m(C)}})}).catch(m)});return x(p,u),p}function Fa(i){var u=this,l=new y(function(p,g){u.ready().then(function(){_e(u._dbInfo,k,function(m,b){if(m)return g(m);try{var j=b.objectStore(u._dbInfo.storeName),S=j.clear();b.oncomplete=function(){p()},b.onabort=b.onerror=function(){var w=S.error?S.error:S.transaction.error;g(w)}}catch(w){g(w)}})}).catch(g)});return x(l,i),l}function Ba(i){var u=this,l=new y(function(p,g){u.ready().then(function(){_e(u._dbInfo,se,function(m,b){if(m)return g(m);try{var j=b.objectStore(u._dbInfo.storeName),S=j.count();S.onsuccess=function(){p(S.result)},S.onerror=function(){g(S.error)}}catch(w){g(w)}})}).catch(g)});return x(l,i),l}function Wa(i,u){var l=this,p=new y(function(g,m){if(i<0){g(null);return}l.ready().then(function(){_e(l._dbInfo,se,function(b,j){if(b)return m(b);try{var S=j.objectStore(l._dbInfo.storeName),w=!1,C=S.openKeyCursor();C.onsuccess=function(){var A=C.result;if(!A){g(null);return}i===0||w?g(A.key):(w=!0,A.advance(i))},C.onerror=function(){m(C.error)}}catch(A){m(A)}})}).catch(m)});return x(p,u),p}function La(i){var u=this,l=new y(function(p,g){u.ready().then(function(){_e(u._dbInfo,se,function(m,b){if(m)return g(m);try{var j=b.objectStore(u._dbInfo.storeName),S=j.openKeyCursor(),w=[];S.onsuccess=function(){var C=S.result;if(!C){p(w);return}w.push(C.key),C.continue()},S.onerror=function(){g(S.error)}}catch(C){g(C)}})}).catch(g)});return x(l,i),l}function Na(i,u){u=$.apply(this,arguments);var l=this.config();i=typeof i!="function"&&i||{},i.name||(i.name=i.name||l.name,i.storeName=i.storeName||l.storeName);var p=this,g;if(!i.name)g=y.reject("Invalid arguments");else{var m=i.name===l.name&&p._dbInfo.db,b=m?y.resolve(p._dbInfo.db):Re(i).then(function(j){var S=P[i.name],w=S.forages;S.db=j;for(var C=0;C<w.length;C++)w[C]._dbInfo.db=j;return j});i.storeName?g=b.then(function(j){if(j.objectStoreNames.contains(i.storeName)){var S=j.version+1;ce(i);var w=P[i.name],C=w.forages;j.close();for(var A=0;A<C.length;A++){var V=C[A];V._dbInfo.db=null,V._dbInfo.version=S}var G=new y(function(X,ae){var re=d.open(i.name,S);re.onerror=function(xe){var Je=re.result;Je.close(),ae(xe)},re.onupgradeneeded=function(){var xe=re.result;xe.deleteObjectStore(i.storeName)},re.onsuccess=function(){var xe=re.result;xe.close(),X(xe)}});return G.then(function(X){w.db=X;for(var ae=0;ae<C.length;ae++){var re=C[ae];re._dbInfo.db=X,pe(re._dbInfo)}}).catch(function(X){throw(ve(i,X)||y.resolve()).catch(function(){}),X})}}):g=b.then(function(j){ce(i);var S=P[i.name],w=S.forages;j.close();for(var C=0;C<w.length;C++){var A=w[C];A._dbInfo.db=null}var V=new y(function(G,X){var ae=d.deleteDatabase(i.name);ae.onerror=function(){var re=ae.result;re&&re.close(),X(ae.error)},ae.onblocked=function(){console.warn('dropInstance blocked for database "'+i.name+'" until all open connections are closed')},ae.onsuccess=function(){var re=ae.result;re&&re.close(),G(re)}});return V.then(function(G){S.db=G;for(var X=0;X<w.length;X++){var ae=w[X];pe(ae._dbInfo)}}).catch(function(G){throw(ve(i,G)||y.resolve()).catch(function(){}),G})})}return x(g,u),g}var za={_driver:"asyncStorage",_initStorage:Ma,_support:f(),iterate:Va,getItem:Ea,setItem:Oa,removeItem:$a,clear:Fa,length:Ba,key:Wa,keys:La,dropInstance:Na};function Ha(){return typeof openDatabase=="function"}var Ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ua="~~local_forage_type~",Xn=/^~~local_forage_type~([^~]+)~/,lt="__lfsc__:",It=lt.length,Dt="arbf",Mt="blob",Qn="si08",Jn="ui08",Kn="uic8",Zn="si16",er="si32",tr="ur16",nr="ui32",rr="fl32",ar="fl64",or=It+Dt.length,ir=Object.prototype.toString;function sr(i){var u=i.length*.75,l=i.length,p,g=0,m,b,j,S;i[i.length-1]==="="&&(u--,i[i.length-2]==="="&&u--);var w=new ArrayBuffer(u),C=new Uint8Array(w);for(p=0;p<l;p+=4)m=Ie.indexOf(i[p]),b=Ie.indexOf(i[p+1]),j=Ie.indexOf(i[p+2]),S=Ie.indexOf(i[p+3]),C[g++]=m<<2|b>>4,C[g++]=(b&15)<<4|j>>2,C[g++]=(j&3)<<6|S&63;return w}function Et(i){var u=new Uint8Array(i),l="",p;for(p=0;p<u.length;p+=3)l+=Ie[u[p]>>2],l+=Ie[(u[p]&3)<<4|u[p+1]>>4],l+=Ie[(u[p+1]&15)<<2|u[p+2]>>6],l+=Ie[u[p+2]&63];return u.length%3===2?l=l.substring(0,l.length-1)+"=":u.length%3===1&&(l=l.substring(0,l.length-2)+"=="),l}function qa(i,u){var l="";if(i&&(l=ir.call(i)),i&&(l==="[object ArrayBuffer]"||i.buffer&&ir.call(i.buffer)==="[object ArrayBuffer]")){var p,g=lt;i instanceof ArrayBuffer?(p=i,g+=Dt):(p=i.buffer,l==="[object Int8Array]"?g+=Qn:l==="[object Uint8Array]"?g+=Jn:l==="[object Uint8ClampedArray]"?g+=Kn:l==="[object Int16Array]"?g+=Zn:l==="[object Uint16Array]"?g+=tr:l==="[object Int32Array]"?g+=er:l==="[object Uint32Array]"?g+=nr:l==="[object Float32Array]"?g+=rr:l==="[object Float64Array]"?g+=ar:u(new Error("Failed to get type for BinaryArray"))),u(g+Et(p))}else if(l==="[object Blob]"){var m=new FileReader;m.onload=function(){var b=Ua+i.type+"~"+Et(this.result);u(lt+Mt+b)},m.readAsArrayBuffer(i)}else try{u(JSON.stringify(i))}catch(b){console.error("Couldn't convert value into a JSON string: ",i),u(null,b)}}function Ga(i){if(i.substring(0,It)!==lt)return JSON.parse(i);var u=i.substring(or),l=i.substring(It,or),p;if(l===Mt&&Xn.test(u)){var g=u.match(Xn);p=g[1],u=u.substring(g[0].length)}var m=sr(u);switch(l){case Dt:return m;case Mt:return v([m],{type:p});case Qn:return new Int8Array(m);case Jn:return new Uint8Array(m);case Kn:return new Uint8ClampedArray(m);case Zn:return new Int16Array(m);case tr:return new Uint16Array(m);case er:return new Int32Array(m);case nr:return new Uint32Array(m);case rr:return new Float32Array(m);case ar:return new Float64Array(m);default:throw new Error("Unkown type: "+l)}}var Vt={serialize:qa,deserialize:Ga,stringToBuffer:sr,bufferToString:Et};function lr(i,u,l,p){i.executeSql("CREATE TABLE IF NOT EXISTS "+u.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],l,p)}function Ya(i){var u=this,l={db:null};if(i)for(var p in i)l[p]=typeof i[p]!="string"?i[p].toString():i[p];var g=new y(function(m,b){try{l.db=openDatabase(l.name,String(l.version),l.description,l.size)}catch(j){return b(j)}l.db.transaction(function(j){lr(j,l,function(){u._dbInfo=l,m()},function(S,w){b(w)})},b)});return l.serializer=Vt,g}function De(i,u,l,p,g,m){i.executeSql(l,p,g,function(b,j){j.code===j.SYNTAX_ERR?b.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[u.storeName],function(S,w){w.rows.length?m(S,j):lr(S,u,function(){S.executeSql(l,p,g,m)},m)},m):m(b,j)},m)}function Xa(i,u){var l=this;i=I(i);var p=new y(function(g,m){l.ready().then(function(){var b=l._dbInfo;b.db.transaction(function(j){De(j,b,"SELECT * FROM "+b.storeName+" WHERE key = ? LIMIT 1",[i],function(S,w){var C=w.rows.length?w.rows.item(0).value:null;C&&(C=b.serializer.deserialize(C)),g(C)},function(S,w){m(w)})})}).catch(m)});return x(p,u),p}function Qa(i,u){var l=this,p=new y(function(g,m){l.ready().then(function(){var b=l._dbInfo;b.db.transaction(function(j){De(j,b,"SELECT * FROM "+b.storeName,[],function(S,w){for(var C=w.rows,A=C.length,V=0;V<A;V++){var G=C.item(V),X=G.value;if(X&&(X=b.serializer.deserialize(X)),X=i(X,G.key,V+1),X!==void 0){g(X);return}}g()},function(S,w){m(w)})})}).catch(m)});return x(p,u),p}function cr(i,u,l,p){var g=this;i=I(i);var m=new y(function(b,j){g.ready().then(function(){u===void 0&&(u=null);var S=u,w=g._dbInfo;w.serializer.serialize(u,function(C,A){A?j(A):w.db.transaction(function(V){De(V,w,"INSERT OR REPLACE INTO "+w.storeName+" (key, value) VALUES (?, ?)",[i,C],function(){b(S)},function(G,X){j(X)})},function(V){if(V.code===V.QUOTA_ERR){if(p>0){b(cr.apply(g,[i,S,l,p-1]));return}j(V)}})})}).catch(j)});return x(m,l),m}function Ja(i,u,l){return cr.apply(this,[i,u,l,1])}function Ka(i,u){var l=this;i=I(i);var p=new y(function(g,m){l.ready().then(function(){var b=l._dbInfo;b.db.transaction(function(j){De(j,b,"DELETE FROM "+b.storeName+" WHERE key = ?",[i],function(){g()},function(S,w){m(w)})})}).catch(m)});return x(p,u),p}function Za(i){var u=this,l=new y(function(p,g){u.ready().then(function(){var m=u._dbInfo;m.db.transaction(function(b){De(b,m,"DELETE FROM "+m.storeName,[],function(){p()},function(j,S){g(S)})})}).catch(g)});return x(l,i),l}function eo(i){var u=this,l=new y(function(p,g){u.ready().then(function(){var m=u._dbInfo;m.db.transaction(function(b){De(b,m,"SELECT COUNT(key) as c FROM "+m.storeName,[],function(j,S){var w=S.rows.item(0).c;p(w)},function(j,S){g(S)})})}).catch(g)});return x(l,i),l}function to(i,u){var l=this,p=new y(function(g,m){l.ready().then(function(){var b=l._dbInfo;b.db.transaction(function(j){De(j,b,"SELECT key FROM "+b.storeName+" WHERE id = ? LIMIT 1",[i+1],function(S,w){var C=w.rows.length?w.rows.item(0).key:null;g(C)},function(S,w){m(w)})})}).catch(m)});return x(p,u),p}function no(i){var u=this,l=new y(function(p,g){u.ready().then(function(){var m=u._dbInfo;m.db.transaction(function(b){De(b,m,"SELECT key FROM "+m.storeName,[],function(j,S){for(var w=[],C=0;C<S.rows.length;C++)w.push(S.rows.item(C).key);p(w)},function(j,S){g(S)})})}).catch(g)});return x(l,i),l}function ro(i){return new y(function(u,l){i.transaction(function(p){p.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(g,m){for(var b=[],j=0;j<m.rows.length;j++)b.push(m.rows.item(j).name);u({db:i,storeNames:b})},function(g,m){l(m)})},function(p){l(p)})})}function ao(i,u){u=$.apply(this,arguments);var l=this.config();i=typeof i!="function"&&i||{},i.name||(i.name=i.name||l.name,i.storeName=i.storeName||l.storeName);var p=this,g;return i.name?g=new y(function(m){var b;i.name===l.name?b=p._dbInfo.db:b=openDatabase(i.name,"","",0),i.storeName?m({db:b,storeNames:[i.storeName]}):m(ro(b))}).then(function(m){return new y(function(b,j){m.db.transaction(function(S){function w(G){return new y(function(X,ae){S.executeSql("DROP TABLE IF EXISTS "+G,[],function(){X()},function(re,xe){ae(xe)})})}for(var C=[],A=0,V=m.storeNames.length;A<V;A++)C.push(w(m.storeNames[A]));y.all(C).then(function(){b()}).catch(function(G){j(G)})},function(S){j(S)})})}):g=y.reject("Invalid arguments"),x(g,u),g}var oo={_driver:"webSQLStorage",_initStorage:Ya,_support:Ha(),iterate:Qa,getItem:Xa,setItem:Ja,removeItem:Ka,clear:Za,length:eo,key:to,keys:no,dropInstance:ao};function io(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function ur(i,u){var l=i.name+"/";return i.storeName!==u.storeName&&(l+=i.storeName+"/"),l}function so(){var i="_localforage_support_test";try{return localStorage.setItem(i,!0),localStorage.removeItem(i),!1}catch{return!0}}function lo(){return!so()||localStorage.length>0}function co(i){var u=this,l={};if(i)for(var p in i)l[p]=i[p];return l.keyPrefix=ur(i,u._defaultConfig),lo()?(u._dbInfo=l,l.serializer=Vt,y.resolve()):y.reject()}function uo(i){var u=this,l=u.ready().then(function(){for(var p=u._dbInfo.keyPrefix,g=localStorage.length-1;g>=0;g--){var m=localStorage.key(g);m.indexOf(p)===0&&localStorage.removeItem(m)}});return x(l,i),l}function ho(i,u){var l=this;i=I(i);var p=l.ready().then(function(){var g=l._dbInfo,m=localStorage.getItem(g.keyPrefix+i);return m&&(m=g.serializer.deserialize(m)),m});return x(p,u),p}function mo(i,u){var l=this,p=l.ready().then(function(){for(var g=l._dbInfo,m=g.keyPrefix,b=m.length,j=localStorage.length,S=1,w=0;w<j;w++){var C=localStorage.key(w);if(C.indexOf(m)===0){var A=localStorage.getItem(C);if(A&&(A=g.serializer.deserialize(A)),A=i(A,C.substring(b),S++),A!==void 0)return A}}});return x(p,u),p}function fo(i,u){var l=this,p=l.ready().then(function(){var g=l._dbInfo,m;try{m=localStorage.key(i)}catch{m=null}return m&&(m=m.substring(g.keyPrefix.length)),m});return x(p,u),p}function po(i){var u=this,l=u.ready().then(function(){for(var p=u._dbInfo,g=localStorage.length,m=[],b=0;b<g;b++){var j=localStorage.key(b);j.indexOf(p.keyPrefix)===0&&m.push(j.substring(p.keyPrefix.length))}return m});return x(l,i),l}function go(i){var u=this,l=u.keys().then(function(p){return p.length});return x(l,i),l}function vo(i,u){var l=this;i=I(i);var p=l.ready().then(function(){var g=l._dbInfo;localStorage.removeItem(g.keyPrefix+i)});return x(p,u),p}function yo(i,u,l){var p=this;i=I(i);var g=p.ready().then(function(){u===void 0&&(u=null);var m=u;return new y(function(b,j){var S=p._dbInfo;S.serializer.serialize(u,function(w,C){if(C)j(C);else try{localStorage.setItem(S.keyPrefix+i,w),b(m)}catch(A){(A.name==="QuotaExceededError"||A.name==="NS_ERROR_DOM_QUOTA_REACHED")&&j(A),j(A)}})})});return x(g,l),g}function xo(i,u){if(u=$.apply(this,arguments),i=typeof i!="function"&&i||{},!i.name){var l=this.config();i.name=i.name||l.name,i.storeName=i.storeName||l.storeName}var p=this,g;return i.name?g=new y(function(m){i.storeName?m(ur(i,p._defaultConfig)):m(i.name+"/")}).then(function(m){for(var b=localStorage.length-1;b>=0;b--){var j=localStorage.key(b);j.indexOf(m)===0&&localStorage.removeItem(j)}}):g=y.reject("Invalid arguments"),x(g,u),g}var bo={_driver:"localStorageWrapper",_initStorage:co,_support:io(),iterate:mo,getItem:ho,setItem:yo,removeItem:vo,clear:uo,length:go,key:fo,keys:po,dropInstance:xo},jo=function(u,l){return u===l||typeof u=="number"&&typeof l=="number"&&isNaN(u)&&isNaN(l)},So=function(u,l){for(var p=u.length,g=0;g<p;){if(jo(u[g],l))return!0;g++}return!1},dr=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"},Qe={},hr={},Le={INDEXEDDB:za,WEBSQL:oo,LOCALSTORAGE:bo},wo=[Le.INDEXEDDB._driver,Le.WEBSQL._driver,Le.LOCALSTORAGE._driver],ct=["dropInstance"],Ot=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ct),Co={description:"",driver:wo.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Ro(i,u){i[u]=function(){var l=arguments;return i.ready().then(function(){return i[u].apply(i,l)})}}function $t(){for(var i=1;i<arguments.length;i++){var u=arguments[i];if(u)for(var l in u)u.hasOwnProperty(l)&&(dr(u[l])?arguments[0][l]=u[l].slice():arguments[0][l]=u[l])}return arguments[0]}var _o=function(){function i(u){h(this,i);for(var l in Le)if(Le.hasOwnProperty(l)){var p=Le[l],g=p._driver;this[l]=g,Qe[g]||this.defineDriver(p)}this._defaultConfig=$t({},Co),this._config=$t({},this._defaultConfig,u),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return i.prototype.config=function(l){if((typeof l>"u"?"undefined":s(l))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var p in l){if(p==="storeName"&&(l[p]=l[p].replace(/\W/g,"_")),p==="version"&&typeof l[p]!="number")return new Error("Database version must be a number.");this._config[p]=l[p]}return"driver"in l&&l.driver?this.setDriver(this._config.driver):!0}else return typeof l=="string"?this._config[l]:this._config},i.prototype.defineDriver=function(l,p,g){var m=new y(function(b,j){try{var S=l._driver,w=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!l._driver){j(w);return}for(var C=Ot.concat("_initStorage"),A=0,V=C.length;A<V;A++){var G=C[A],X=!So(ct,G);if((X||l[G])&&typeof l[G]!="function"){j(w);return}}var ae=function(){for(var Je=function(Po){return function(){var To=new Error("Method "+Po+" is not implemented by the current driver"),mr=y.reject(To);return x(mr,arguments[arguments.length-1]),mr}},Ft=0,Ao=ct.length;Ft<Ao;Ft++){var Bt=ct[Ft];l[Bt]||(l[Bt]=Je(Bt))}};ae();var re=function(Je){Qe[S]&&console.info("Redefining LocalForage driver: "+S),Qe[S]=l,hr[S]=Je,b()};"_support"in l?l._support&&typeof l._support=="function"?l._support().then(re,j):re(!!l._support):re(!0)}catch(xe){j(xe)}});return R(m,p,g),m},i.prototype.driver=function(){return this._driver||null},i.prototype.getDriver=function(l,p,g){var m=Qe[l]?y.resolve(Qe[l]):y.reject(new Error("Driver not found."));return R(m,p,g),m},i.prototype.getSerializer=function(l){var p=y.resolve(Vt);return R(p,l),p},i.prototype.ready=function(l){var p=this,g=p._driverSet.then(function(){return p._ready===null&&(p._ready=p._initDriver()),p._ready});return R(g,l,l),g},i.prototype.setDriver=function(l,p,g){var m=this;dr(l)||(l=[l]);var b=this._getSupportedDrivers(l);function j(){m._config.driver=m.driver()}function S(A){return m._extend(A),j(),m._ready=m._initStorage(m._config),m._ready}function w(A){return function(){var V=0;function G(){for(;V<A.length;){var X=A[V];return V++,m._dbInfo=null,m._ready=null,m.getDriver(X).then(S).catch(G)}j();var ae=new Error("No available storage method found.");return m._driverSet=y.reject(ae),m._driverSet}return G()}}var C=this._driverSet!==null?this._driverSet.catch(function(){return y.resolve()}):y.resolve();return this._driverSet=C.then(function(){var A=b[0];return m._dbInfo=null,m._ready=null,m.getDriver(A).then(function(V){m._driver=V._driver,j(),m._wrapLibraryMethodsWithReady(),m._initDriver=w(b)})}).catch(function(){j();var A=new Error("No available storage method found.");return m._driverSet=y.reject(A),m._driverSet}),R(this._driverSet,p,g),this._driverSet},i.prototype.supports=function(l){return!!hr[l]},i.prototype._extend=function(l){$t(this,l)},i.prototype._getSupportedDrivers=function(l){for(var p=[],g=0,m=l.length;g<m;g++){var b=l[g];this.supports(b)&&p.push(b)}return p},i.prototype._wrapLibraryMethodsWithReady=function(){for(var l=0,p=Ot.length;l<p;l++)Ro(this,Ot[l])},i.prototype.createInstance=function(l){return new i(l)},i}(),ko=new _o;r.exports=ko},{3:3}]},{},[4])(4)})})(wi);const ft=zt,Or=ft.createInstance({driver:ft.LOCALSTORAGE}),Fe=ft.createInstance({name:"xrabDB",storeName:"rosterStore"}),tn=ft.createInstance({name:"xrabDB",storeName:"dataStore"}),pt=()=>({unitData:{},xenosRulesData:{},rulesData:{},psychicPowers:{}}),Ne={unitData:ji,xenosRulesData:Si,rulesData:xi,psychicPowers:gi,traitData:bi,customData:pt()},$r=Mo("data/hydrateData",async()=>{const t=await tn.getItem("data");return t!==null?t:null}),Fr=vt({name:"data",initialState:Ne,reducers:{_setData:(t,n)=>({...n.payload})},extraReducers:t=>{t.addCase($r.fulfilled,(n,a)=>{const r=a.payload;return r===null?n:{unitData:{...Ne.unitData,...r.unitData},xenosRulesData:{...Ne.xenosRulesData,...r.xenosRulesData},rulesData:{...Ne.rulesData,...r.rulesData},psychicPowers:{...Ne.psychicPowers,...r.psychicPowers},traitData:{...Ne.traitData},customData:r}})}}),{_setData:Br}=Fr.actions,Wr=Oe([t=>t.data.unitData],t=>Object.keys(t).slice(1)),Lr=Oe([t=>t.data.rulesData,t=>t.data.xenosRulesData],(t,n)=>({...t,...n})),nn=t=>(n,a)=>{const r=Ue(a().data,o=>{Object.keys(t).forEach(s=>{Object.values(t[s]).forEach(h=>{o[s][h.name]=h,o.customData[s][h.name]=h})})});tn.setItem("data",r.customData).catch(o=>console.log(o)),n(Br(r))},kt=t=>n=>{const a=pt();return a[t][n.name]=n,nn(a)},At=t=>n=>(a,r)=>{const o=Ue(r().data,s=>{delete s[t][n],delete s.customData[t][n]});tn.setItem("data",o.customData).catch(s=>console.log(s)),a(Br(o))},Ci=kt("unitData"),Ri=At("unitData"),_i=kt("xenosRulesData"),ki=At("xenosRulesData"),Ai=kt("psychicPowers"),Pi=At("psychicPowers"),Ti=kt("rulesData"),Ii=At("rulesData"),Di=Fr.reducer;var rn={},W={},Mi={get exports(){return W},set exports(t){W=t}};(function(t){function n(a){return a&&a.__esModule?a:{default:a}}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(Mi);var L={},Ei={get exports(){return L},set exports(t){L=t}},Ht={},Vi={get exports(){return Ht},set exports(t){Ht=t}};(function(t){function n(a){return t.exports=n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},t.exports.__esModule=!0,t.exports.default=t.exports,n(a)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(Vi);(function(t){var n=Ht.default;function a(o){if(typeof WeakMap!="function")return null;var s=new WeakMap,h=new WeakMap;return(a=function(d){return d?h:s})(o)}function r(o,s){if(!s&&o&&o.__esModule)return o;if(o===null||n(o)!=="object"&&typeof o!="function")return{default:o};var h=a(s);if(h&&h.has(o))return h.get(o);var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in o)if(f!=="default"&&Object.prototype.hasOwnProperty.call(o,f)){var v=d?Object.getOwnPropertyDescriptor(o,f):null;v&&(v.get||v.set)?Object.defineProperty(c,f,v):c[f]=o[f]}return c.default=o,h&&h.set(o,c),c}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(Ei);var Wt={};const Oi=Io(Fo);var gr;function H(){return gr||(gr=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.createSvgIcon}});var n=Oi}(Wt)),Wt}var $i=W,Fi=L;Object.defineProperty(rn,"__esModule",{value:!0});var an=rn.default=void 0,Bi=Fi(M),Wi=$i(H()),Li=(0,Wi.default)(Bi.createElement("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");an=rn.default=Li;var on={},Ni=W,zi=L;Object.defineProperty(on,"__esModule",{value:!0});var Nr=on.default=void 0,Hi=zi(M),Ui=Ni(H()),qi=(0,Ui.default)(Hi.createElement("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"}),"Replay");Nr=on.default=qi;var sn={},Gi=W,Yi=L;Object.defineProperty(sn,"__esModule",{value:!0});var zr=sn.default=void 0,Xi=Yi(M),Qi=Gi(H()),Ji=(0,Qi.default)(Xi.createElement("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"}),"Visibility");zr=sn.default=Ji;const vr={name:"New List",units:[]},yr={name:"Commander 1",commanderTraits:[],removedCommanderTraits:[],detachmentExpansions:0,missesGame:!1,initialCareerPoints:10,careerPointAdjustment:0,battles:[]},ln=vt({name:"roster",initialState:vr,reducers:{newRoster:()=>({...vr}),setRoster:(t,n)=>({...n.payload}),updateRoster:(t,n)=>({...t,...n.payload}),_addUnit:(t,n)=>{let[a,r,o]=n.payload;r=r||{...a.unitData.Unit,options:[],xenosRules:[]},o==null?t.units.push(r):t.units.splice(o+1,0,r)},_setUnit:(t,n)=>{const[a,r,o]=n.payload;t.units[r]={...a.unitData[o],options:[],xenosRules:[]}},updateUnit:{reducer:(t,n)=>{const[a,r]=n.payload;t.units[a]={...t.units[a],...r}},prepare:(t,n)=>({payload:[t,n]})},removeUnit:(t,n)=>{const a=n.payload;t.units.splice(a,1)},renameUnit:{reducer:(t,n)=>{const[a,r]=n.payload;t.units[a].customName=r},prepare:(t,n)=>({payload:[t,n]})},moveUnit:{reducer:(t,n)=>{const[a,r]=n.payload,o=r==="left"?a-1:a+1;if(o<0||o>=t.units.length)return t;[t.units[o],t.units[a]]=[t.units[a],t.units[o]]},prepare:(t,n)=>({payload:[t,n]})},addCampaign:t=>{t.campaign={commanders:[{...yr}],retirements:0}},addCommander:t=>{var r,o,s;const n=((r=t.campaign)==null?void 0:r.retirements)||0,a=n===1?5:n>1?0:10;(s=t.campaign)==null||s.commanders.push({...yr,name:"Commander "+(((o=t.campaign)==null?void 0:o.commanders.length)+1).toString(),initialCareerPoints:a})},adjustCareerPoints:(t,n)=>{const a=n.payload;if(t.campaign){const r=t.campaign.commanders.length-1;t.campaign.commanders[r].careerPointAdjustment=a}},setCommanderName:(t,n)=>{const a=n.payload;if(t.campaign){const r=t.campaign.commanders.length-1;t.campaign.commanders[r].name=a}},addTrait:(t,n)=>{const a=n.payload;if(t.campaign){const r=t.campaign.commanders.length-1;t.campaign.commanders[r].commanderTraits=[...a]}},removeTrait:(t,n)=>{const a=n.payload;if(t.campaign){const r=t.campaign.commanders.length-1;t.campaign.commanders[r].removedCommanderTraits=[...a]}},adjustDetachmentExpansions:(t,n)=>{const a=n.payload;if(t.campaign){const r=t.campaign.commanders.length-1;t.campaign.commanders[r].detachmentExpansions+a>0?t.campaign.commanders[r].detachmentExpansions+=a:t.campaign.commanders[r].detachmentExpansions=0}},addRetirement:t=>{t.campaign&&(t.campaign.retirements+=1)},addBattle:(t,n)=>{const a=n.payload;if(t.campaign){const r=t.campaign.commanders.length-1;t.campaign.commanders[r].battles.push(a)}},removeBattle:(t,n)=>{const{commanderIndex:a,battleIndex:r}=n.payload;t.campaign&&t.campaign.commanders[a].battles.splice(r,1)},editBattle:{reducer:(t,n)=>{const[a,{commanderIndex:r,battleIndex:o}]=n.payload;t.campaign&&(t.campaign.commanders[r].battles[o]=a)},prepare:(t,n)=>({payload:[t,n]})}}}),{_addUnit:Ki,_setUnit:Zi}=ln.actions,Hr=(t,n)=>(a,r)=>{const o=r().data;a(Ki([o,t,n]))},es=(t,n)=>(a,r)=>{const o=r().data;a(Zi([o,t,n]))},Ur=Oe(t=>t,t=>Object.values(t).reduce((n,a)=>n+a.points,0)),ts=Oe(t=>t.roster.units,t=>Lr(t),(t,n)=>{const a=new Set;return t.forEach(r=>r.rules.forEach(o=>a.add(o))),[...a].sort().reduce((r,o)=>n[o]?{...r,[o]:n[o]}:r,{})}),ns=Oe(t=>t.roster.units,t=>t.data.psychicPowers,(t,n)=>{const a=new Set;return t.forEach(r=>{var o;return(o=r.psiPowers)==null?void 0:o.forEach(s=>a.add(s))}),[...a].sort().reduce((r,o)=>({...r,[o]:n[o]}),{})}),rs=Oe(t=>{var n;return(n=t.roster.campaign)==null?void 0:n.commanders},t=>t?t.reduce((n,a)=>a.battles.reduce((r,o)=>r+o.victoryPoints,n),0):0),qr=Oe(t=>{var n;return(n=t.roster.campaign)==null?void 0:n.commanders},t=>t?t[t.length-1]:null),as=Oe(t=>{var n;return(n=t.roster.campaign)==null?void 0:n.commanders},t=>{if(!t)return[[],[]];const n=[],a=[];return t.forEach((r,o)=>{r.battles.forEach((s,h)=>{n.push({commander:r.name,...s}),a.push({commanderIndex:o,battleIndex:h})})}),[n,a]}),{newRoster:os,setRoster:Gr,updateRoster:is,updateUnit:ss,removeUnit:ls,renameUnit:cs,moveUnit:xr,addCampaign:us,addCommander:br,adjustCareerPoints:ds,setCommanderName:hs,addTrait:ms,removeTrait:fs,adjustDetachmentExpansions:jr,addRetirement:ps,addBattle:gs,editBattle:vs,removeBattle:ys}=ln.actions,xs=ln.reducer;var cn={},bs=W,js=L;Object.defineProperty(cn,"__esModule",{value:!0});var Yr=cn.default=void 0,Ss=js(M),ws=bs(H()),Cs=(0,ws.default)(Ss.createElement("path",{d:"M3 21h18v-2H3v2zM3 8v8l4-4-4-4zm8 9h10v-2H11v2zM3 3v2h18V3H3zm8 6h10V7H11v2zm0 4h10v-2H11v2z"}),"FormatIndentIncrease");Yr=cn.default=Cs;const Rs=()=>{try{const t=localStorage.getItem("localforage/uiOptions");if(t!==null)return JSON.parse(t)}catch(t){console.log(t)}return{viewMode:!1,editMode:!1,inlineRules:!0,darkMode:null,validationExpanded:!0,rulesSummaryExpanded:!0,campaignExpanded:!1,powersExpanded:!1,statisticsExpanded:!0}},Xr=vt({name:"ui",initialState:Rs(),reducers:{_setUI:(t,n)=>({...n.payload}),_toggleUIOption:(t,n)=>{const a=n.payload;t[a]=!t[a]},_updateUI:(t,n)=>({...t,...n.payload})}}),{_setUI:fh,_toggleUIOption:_s,_updateUI:ks}=Xr.actions,ot=t=>(n,a)=>{const r=a().ui;Or.setItem("uiOptions",{...r,[t]:!r[t]}).catch(o=>console.log(o)),n(_s(t))},Ut=t=>(n,a)=>{const r=a().ui;Or.setItem("uiOptions",{...r,...t}).catch(o=>console.log(o)),n(ks(t))},As=Xr.reducer,Ps=({showText:t})=>{const n=D(o=>o.ui.inlineRules),a=U(),r=()=>{a(ot("inlineRules"))};return e.jsxs(e.Fragment,{children:[e.jsx(ee,{title:"Show short rules inline",children:e.jsx(te,{onClick:r,color:"inherit","aria-label":"Toggle show short rules inline",children:e.jsx(Yr,{color:n?"inherit":"disabled"})})}),t&&e.jsx(T,{color:n?"inherit":"textSecondary",onClick:r,children:"Inline rules"})]})},Qr=B.memo(Ps);var un={},Ts=W,Is=L;Object.defineProperty(un,"__esModule",{value:!0});var Jr=un.default=void 0,Ds=Is(M),Ms=Ts(H()),Es=(0,Ms.default)(Ds.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm2 16H5V5h11.17L19 7.83V19zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3zM6 6h9v4H6z"}),"SaveOutlined");Jr=un.default=Es;const de=(t=!1,n,a)=>{const[r,o]=B.useState(t);return[r,()=>{o(!0),n&&n()},()=>{a&&a(),o(!1)}]},Kr=({anchor:t,action:n,options:a,title:r,onClose:o,onOpen:s})=>{const[h,c,d]=de(!1,s,o),f=y=>{n(y),d()},v=typeof a[0]=="string"?a.map(y=>[y,null]):a;return e.jsxs(e.Fragment,{children:[e.jsx(E,{display:"flex",alignItems:"center",onClick:c,children:t}),e.jsxs(me,{onClose:d,open:h,children:[e.jsx(fe,{children:r}),e.jsx(be,{children:v.map(([y,x])=>e.jsxs(q,{button:!0,onClick:()=>f(y),children:[x&&e.jsx(Yt,{children:x}),y]},y))})]})]})},dn=({action:t,options:n,title:a,text:r,icon:o,showText:s,onClose:h,onOpen:c})=>e.jsx(Kr,{action:t,onOpen:c,anchor:e.jsxs(e.Fragment,{children:[e.jsx(ee,{title:r,children:e.jsx(te,{color:"inherit","aria-label":r,children:o})}),s&&e.jsx(T,{children:r})]}),options:n,title:a,onClose:h});var hn={},Vs=W,Os=L;Object.defineProperty(hn,"__esModule",{value:!0});var mn=hn.default=void 0,$s=Os(M),Fs=Vs(H()),Bs=(0,Fs.default)($s.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");mn=hn.default=Bs;var fn={},Ws=W,Ls=L;Object.defineProperty(fn,"__esModule",{value:!0});var Zr=fn.default=void 0,Ns=Ls(M),zs=Ws(H()),Hs=(0,zs.default)(Ns.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");Zr=fn.default=Hs;var pn={},Us=W,qs=L;Object.defineProperty(pn,"__esModule",{value:!0});var Ee=pn.default=void 0,Gs=qs(M),Ys=Us(H()),Xs=(0,Ys.default)(Gs.createElement("path",{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");Ee=pn.default=Xs;const Qs=$e(t=>({expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"}})),Js=({expanded:t,onClick:n})=>{const a=Qs();return e.jsx(te,{className:Bo(a.expand,{[a.expandOpen]:t}),onClick:n,children:e.jsx(Ee,{})})},Ks=B.memo(Js);var gn={},Zs=W,el=L;Object.defineProperty(gn,"__esModule",{value:!0});var ea=gn.default=void 0,tl=el(M),nl=Zs(H()),rl=(0,nl.default)(tl.createElement("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore");ea=gn.default=rl;var vn={},al=W,ol=L;Object.defineProperty(vn,"__esModule",{value:!0});var ta=vn.default=void 0,il=ol(M),sl=al(H()),ll=(0,sl.default)(il.createElement("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext");ta=vn.default=ll;var yn={},cl=W,ul=L;Object.defineProperty(yn,"__esModule",{value:!0});var na=yn.default=void 0,dl=ul(M),hl=cl(H()),ml=(0,hl.default)(dl.createElement("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm0 8c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4zm-6 4c.22-.72 3.31-2 6-2 2.7 0 5.8 1.29 6 2H9zm-3-3v-3h3v-2H6V7H4v3H1v2h3v3z"}),"PersonAddOutlined");na=yn.default=ml;var xn={},fl=W,pl=L;Object.defineProperty(xn,"__esModule",{value:!0});var ra=xn.default=void 0,gl=pl(M),vl=fl(H()),yl=(0,vl.default)(gl.createElement("path",{d:"M2.5 4v3h5v12h3V7h5V4h-13zm19 5h-9v3h3v7h3v-7h3V9z"}),"TextFields");ra=xn.default=yl;const aa=({anchor:t,action:n,title:a="",label:r="",defaultValue:o="",cancelText:s="Cancel",okayText:h="Okay",margin:c="dense",onClose:d,onOpen:f})=>{const[v,y,x]=de(!1,f,d),[R,I]=B.useState(""),$=Y=>{Y==="Enter"?(n(R),x()):Y==="ESC"&&x()},F=()=>{n(R),x()};return e.jsxs(e.Fragment,{children:[e.jsx(E,{display:"flex",alignItems:"center",onClick:y,children:t}),e.jsxs(me,{onClose:x,open:v,children:[e.jsx(fe,{children:a}),e.jsx(je,{children:e.jsx(Ze,{autoFocus:!0,margin:c,label:r,type:"text",fullWidth:!0,defaultValue:o||R,onChange:Y=>I(Y.target.value),onKeyPress:Y=>$(Y.key)})}),e.jsxs(Se,{children:[e.jsx(z,{onClick:x,color:"primary",children:s}),e.jsx(z,{onClick:F,disabled:!R,color:"primary",children:h})]})]})]})},xl=({id:t,unit:n})=>{const a=U(),r=()=>a(xr(t,"left")),o=()=>a(xr(t,"right")),s=()=>a(Hr(n,t)),h=c=>a(cs(t,c));return e.jsx(E,{style:{position:"absolute",bottom:5,width:"95%",paddingRight:15},children:e.jsxs(E,{display:"flex",style:{height:25},children:[e.jsxs(E,{display:"flex",alignItems:"center",children:[e.jsx(ee,{title:"Move back",children:e.jsx(te,{onClick:r,children:e.jsx(ea,{})})}),e.jsx(ee,{title:"Move forward",children:e.jsx(te,{onClick:o,children:e.jsx(ta,{})})})]}),e.jsx(E,{flexGrow:1}),e.jsxs(E,{display:"flex",alignItems:"center",children:[e.jsx(aa,{anchor:e.jsx(ee,{title:"Rename unit",children:e.jsx(te,{children:e.jsx(ra,{})})}),action:h,title:"Enter the name for the unit",label:"Unit name",defaultValue:n.customName,okayText:"Rename"}),e.jsx(ee,{title:"Clone unit",children:e.jsx(te,{onClick:s,children:e.jsx(na,{})})})]})]})})},bl=({rules:t})=>{const n=D(o=>qr(o)),a=D(o=>o.data.traitData),r=D(o=>o.ui.inlineRules);if(t&&t.includes("Commander")&&n){const o=n.commanderTraits.filter(s=>!n.removedCommanderTraits.includes(s));return e.jsxs(xt,{children:[e.jsx(T,{variant:"h4",children:"Traits"}),e.jsx(be,{dense:!0,children:o.map(s=>{var h,c;return e.jsx(ee,{title:a[s].description,children:e.jsx(q,{children:e.jsx(ue,{primary:s,secondary:r&&(((h=a[s])==null?void 0:h.short)||((c=a[s])==null?void 0:c.description))||"",primaryTypographyProps:{variant:"body2"},style:{margin:0}})},s)},s)})})]})}return e.jsx(e.Fragment,{})};var bn={},jl=W,Sl=L;Object.defineProperty(bn,"__esModule",{value:!0});var it=bn.default=void 0,wl=Sl(M),Cl=jl(H()),Rl=(0,Cl.default)(wl.createElement("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown");it=bn.default=Rl;const _l=({unit:t,onChange:n})=>{const[a,r,o]=de(),s=D(d=>d.data.unitData[t.name].options),h=D(d=>d.ui.inlineRules);if(!s||!Object.keys(s).length)return e.jsx("div",{});const c=d=>n({...t,options:[...d.target.value]});return e.jsxs(e.Fragment,{children:[e.jsxs(bt,{onClick:r,component:"legend",children:["Options ",e.jsx(it,{})]}),t.options.map(d=>e.jsx("div",{children:e.jsx(Xt,{control:e.jsx(Qt,{checked:!0,onChange:()=>n({...t,options:[...t.options.filter(f=>f!==d)]})}),label:e.jsx(ee,{title:s[d].description,children:e.jsxs(T,{children:[d," ",e.jsxs(T,{color:"secondary",component:"span",children:["@",s[d].points]})]})})},d)},d)),e.jsx(Pe,{style:{margin:0,width:0,height:0},children:e.jsx(Ge,{open:a,onClose:o,onOpen:r,IconComponent:()=>e.jsx(E,{}),multiple:!0,value:t.options,onChange:c,input:e.jsx(et,{}),renderValue:()=>" ",children:Object.keys(s).map(d=>{var f,v,y;return e.jsx(q,{value:d,dense:!0,style:{maxWidth:400},disabled:((f=s[d].disabledBy)==null?void 0:f.some(x=>t.options.includes(x)))||s[d].enabledBy&&!((v=s[d].enabledBy)!=null&&v.some(x=>t.options.includes(x))),children:e.jsx(ee,{title:s[d].description,children:e.jsx(ue,{primary:e.jsxs(T,{variant:"body2",color:t.options.indexOf(d)>-1?"primary":"inherit",children:[d," ",e.jsxs(T,{color:"secondary",variant:"body2",component:"span",children:["@",s[d].points]})]}),secondary:h&&((y=s[d])==null?void 0:y.short)||"",primaryTypographyProps:{variant:"body2"},style:{margin:0}})})},d)})})})]})},kl=({rules:t})=>{const n=D(r=>Lr(r)),a=D(r=>r.ui.inlineRules);return t&&t.length?e.jsxs(xt,{children:[e.jsx(T,{variant:"h4",children:"Special Rules"}),e.jsx(be,{dense:!0,children:t.map(r=>{var o,s;return e.jsx(ee,{title:((o=n[r])==null?void 0:o.description)||"",children:e.jsx(q,{children:e.jsx(ue,{primary:r,secondary:a&&((s=n[r])==null?void 0:s.short)||"",primaryTypographyProps:{variant:"body2"},style:{margin:0}})},r)},r)})})]}):e.jsx(e.Fragment,{})},le=(t,n)=>Array(n+1-t).fill(t).map((a,r)=>a+r),He={attack:{name:"Attack",shortName:"A",range:le(2,12),adjustRange:le(-12,12),suffix:"+"},attackValue:{name:"Attack Value",shortName:"AV",range:le(2,6),adjustRange:le(-6,6),suffix:"+"},move:{name:"Move",shortName:"M",range:le(2,12),adjustRange:le(-12,12),suffix:"+"},defenceValue:{name:"Defence Value",shortName:"DV",range:le(2,6),adjustRange:le(-6,6),suffix:"+"},shoot:{name:"Shoot",shortName:"S",range:[0,2,3,4,5,6,7,8,9,10,11,12],adjustRange:le(-12,12),suffix:"+"},shootValue:{name:"Shoot Value",shortName:"SV",range:[0,2,3,4,5,6],adjustRange:le(-6,6),suffix:"+"},courage:{name:"Courage",shortName:"C",range:le(2,12),adjustRange:le(-12,12),suffix:"+"},shootRange:{name:"Shooting Range",shortName:"SR",range:[0,6,12,18,24],adjustRange:[-24,-18,-12,-6,0,6,12,18,24],suffix:""},armor:{name:"Armor",shortName:"Ar",range:le(0,6),adjustRange:le(-6,6),suffix:""},movement:{name:"Movement",shortName:"MR",range:[0,2,4,6,8,10,12,14,16,18],adjustRange:[-18,-16,-14,-12,-10,-8,-6,-4,-2,2,4,6,8,10,12,14,16,18],suffix:'"'},strengthPoints:{name:"Strength Points",shortName:"SP",range:[5,10],adjustRange:[-10,-5,5,10],suffix:""}},we=({stat:t,stats:n,freeActivations:a,isPhone:r,overrideValue:o})=>{const s=He[t],h=o||(n[t]?n[t]+s.suffix:"-");return e.jsxs(e.Fragment,{children:[e.jsx(ne,{children:r?s.shortName:s.name}),a.includes(t)?e.jsx(ne,{children:e.jsx(T,{color:"secondary",variant:"inherit",children:h})}):e.jsx(ne,{children:h})]})},Al=({stats:t,freeActivations:n})=>{const a=Jt(),r=yt(a.breakpoints.down("xs")),o={stats:t,freeActivations:n,isPhone:r},s=t.shoot?`${t.shootValue}+/${t.shootRange}"`:"-";return e.jsx(jt,{style:{marginBottom:20},children:e.jsx(St,{size:"small",children:e.jsxs(wt,{children:[e.jsxs(he,{children:[e.jsx(we,{stat:"attack",...o}),e.jsx(we,{stat:"attackValue",...o})]}),e.jsxs(he,{children:[e.jsx(we,{stat:"move",...o}),e.jsx(we,{stat:"defenceValue",...o})]}),e.jsxs(he,{children:[e.jsx(we,{stat:"shoot",...o}),e.jsx(we,{stat:"shootValue",overrideValue:s,...o})]}),e.jsxs(he,{children:[e.jsx(we,{stat:"courage",...o}),e.jsx(we,{stat:"movement",...o})]}),e.jsxs(he,{children:[e.jsx(we,{stat:"armor",...o}),e.jsx(we,{stat:"strengthPoints",...o})]})]})})})},Pl=({unit:t,id:n})=>{const a=D(h=>Wr(h)),r=U(),o=t.customName?t.customName:t.name,s=h=>{h!==t.name&&r(es(n,h))};return e.jsx(Kr,{action:s,anchor:e.jsxs(e.Fragment,{children:[e.jsxs(T,{variant:"h3",children:[e.jsx(qe,{label:t.points,color:"primary"}),"  ",o,e.jsx(it,{})]}),t.customName&&e.jsx(T,{style:{marginLeft:45,marginBottom:-25},children:t.name})]}),options:a,title:"Choose unit type"})},Tl=({unit:t,onChange:n})=>{const[a,r,o]=de(),s=D(f=>f.data.xenosRulesData),h=D(f=>f.ui.inlineRules),c=Object.keys(s).filter(f=>!s[f].exclude_units.includes(t.name)),d=f=>n({...t,xenosRules:[...f.target.value]});return e.jsxs(e.Fragment,{children:[e.jsxs(bt,{onClick:r,component:"legend",style:{marginTop:5},children:["Xenos Rules ",e.jsx(it,{})]}),t.xenosRules&&t.xenosRules.length>0&&t.xenosRules.map(f=>e.jsx("div",{children:e.jsx(Xt,{control:e.jsx(Qt,{checked:!0,onChange:()=>n({...t,xenosRules:[...t.xenosRules.filter(v=>v!==f)]})}),label:e.jsx(ee,{title:s[f].description,children:e.jsxs(T,{children:[f," ",e.jsxs(T,{color:"secondary",component:"span",children:["@",s[f].points]})]})})},f)},f)),e.jsx(Pe,{style:{marginTop:0,width:0,height:0},children:e.jsx(Ge,{open:a,onClose:o,onOpen:r,IconComponent:()=>e.jsx(E,{}),multiple:!0,value:t.xenosRules,onChange:d,input:e.jsx(et,{}),renderValue:()=>" ",children:c.map(f=>{var v;return e.jsx(q,{value:f,dense:!0,style:{maxWidth:400},children:e.jsx(ee,{title:s[f].description,children:e.jsx(ue,{primary:e.jsxs(T,{variant:"body2",color:t.xenosRules.indexOf(f)>-1?"primary":"inherit",children:[f," ",e.jsxs(T,{color:"secondary",component:"span",variant:"body2",children:["@",s[f].points]})]}),secondary:h&&((v=s[f])==null?void 0:v.short)||"",style:{margin:0}})})},f)})})})]})},Il=Eo({ui:As,roster:xs,appState:fi,data:Di}),qt=Vo({reducer:Il}),oa=t=>{const n=qt.getState().data.unitData[t.name],a=qt.getState().data.xenosRulesData;let r={...n,customName:t.customName||"",options:[...t.options],xenosRules:[...t.xenosRules],psiPowers:t.psiPowers||[]},o=n.points,s={};for(const h of r.options){const c=n.options[h];if(o+=c.points||0,c.setStats)for(const[d,f]of Object.entries(c.setStats))r={...r,stats:{...r.stats,[d]:f}};if(c.adjustStats&&(s={...s,...c.adjustStats}),c.add)for(const d of c.add)r.rules=[...r.rules,d];if(c.remove)for(const d of c.remove)r.rules=r.rules.filter(f=>f!==d)}for(const h of r.xenosRules){const c=a[h];if(o+=c.points,r.rules=[...r.rules,c.name],c.setStats)for(const[d,f]of Object.entries(c.setStats))r={...r,stats:{...r.stats,[d]:f}};c.adjustStats&&(s={...s,...c.adjustStats})}for(const[h,c]of Object.entries(s)){const d=h,f=r.stats[d];c&&typeof c=="number"&&typeof f=="number"&&(r={...r,stats:{...r.stats,[h]:f+c}})}return r.xenosRules.some(h=>["Psychic 1","Psychic 2","Psychic 3","Psychic 4"].includes(h))||(r={...r,psiPowers:[]}),r.rules.length>0&&(r={...r,rules:[...r.rules].sort()}),r={...r,points:o},r},Dl=({unit:t,onChange:n})=>{const[a,r,o]=de(),s=D(v=>v.data.psychicPowers),h=D(v=>v.ui.inlineRules),c=D(v=>v.ui.viewMode),d=D(v=>v.ui.editMode);if(!t.xenosRules.some(v=>["Psychic 1","Psychic 2","Psychic 3","Psychic 4"].includes(v)))return e.jsx("div",{});const f=v=>n({...t,psiPowers:[...v.target.value]});return e.jsxs(E,{marginBottom:"-20px",children:[!c&&e.jsxs(bt,{onClick:r,component:"legend",children:["Psychic Powers ",e.jsx(it,{})]}),e.jsxs(xt,{style:{marginBottom:0},children:[c&&e.jsx(T,{variant:"h4",children:"Psychic Powers"}),t.psiPowers&&e.jsx(be,{dense:!0,children:e.jsx(E,{marginLeft:h?"inherit":"1rem",children:t.psiPowers.map((v,y,x)=>{var R,I;return e.jsx(ee,{title:((R=s[v])==null?void 0:R.effect)||"",children:t.psiPowers&&!d&&h?e.jsx(q,{children:e.jsx(ue,{primary:v,secondary:((I=s[v])==null?void 0:I.short)||"",primaryTypographyProps:{variant:"body2"},style:{margin:0}})},v):e.jsxs(T,{variant:"inherit",children:[v,y===x.length-1?"":", "]},v)},v)})})})]}),e.jsx(Pe,{style:{marginTop:10,width:0,height:0},children:e.jsx(Ge,{open:a,onClose:o,onOpen:r,IconComponent:()=>e.jsx(E,{}),multiple:!0,value:t.psiPowers,onChange:f,input:e.jsx(et,{}),renderValue:()=>" ",children:Object.keys(s).map(v=>{var y;return e.jsx(q,{value:v,dense:!0,style:{maxWidth:400},children:e.jsx(ee,{title:s[v].effect,children:e.jsx(ue,{primary:v,secondary:h&&((y=s[v])==null?void 0:y.short)||"",primaryTypographyProps:{color:t.psiPowers&&t.psiPowers.indexOf(v)>-1?"primary":"inherit"},style:{margin:0}})})},v)})})})]})},Ml=({id:t})=>{const n=U(),a=D(v=>v.roster.units[t]),r=D(v=>v.ui.viewMode),o=D(v=>v.ui.editMode),[s,h]=B.useState(!0),c=()=>h(!s),d=v=>{v=oa(v),n(ss(t,{...v}))},f=()=>n(ls(t));return e.jsxs(Rr,{style:{marginBottom:25,maxWidth:400,width:"100%",position:"relative"},children:[r?e.jsx(Lt,{title:e.jsxs(e.Fragment,{children:[e.jsxs(T,{variant:"h3",children:[e.jsx(qe,{label:a.points,color:"primary"}),"  ",a.customName?a.customName:a.name]}),a.customName&&(s?e.jsx(T,{style:{marginLeft:45,marginBottom:-25},children:a.name}):e.jsx(T,{style:{marginLeft:45},children:a.name}))]}),action:e.jsx(Ks,{expanded:s,onClick:c})}):e.jsx(Lt,{title:e.jsx(Pl,{unit:a,id:t}),action:e.jsx(z,{onClick:f,children:e.jsx(Zr,{})})}),e.jsx(_r,{in:!r||s,timeout:"auto",unmountOnExit:!0,children:e.jsxs(kr,{children:[!o&&e.jsxs(e.Fragment,{children:[e.jsx(Al,{stats:a.stats,freeActivations:a.freeActivations}),e.jsx(kl,{rules:a.rules}),e.jsx(bl,{rules:a.rules})]}),e.jsx(Dl,{onChange:d,unit:a}),!r&&e.jsxs(e.Fragment,{children:[e.jsx(_l,{onChange:d,unit:a}),e.jsx(Tl,{onChange:d,unit:a}),e.jsx(xl,{id:t,unit:a})]})]})})]})},El=B.memo(Ml),ia=t=>{const n=t.units.map(a=>{const r={name:a.name,options:a.options,xenosRules:a.xenosRules};return a.customName&&(r.customName=a.customName),a.psiPowers&&a.psiPowers.length>0&&(r.psiPowers=a.psiPowers),r});return{...t,units:n}},sa=t=>{const n=Object.values(t.units).map(a=>oa(a));return{...t,units:n}},Vl=()=>{const t=U(),n=D(r=>r.roster),a=D(r=>r.ui.viewMode);return e.jsxs(e.Fragment,{children:[e.jsx(E,{display:"flex",flexDirection:"row",flexWrap:"wrap",children:n.units.map((r,o)=>e.jsx(El,{id:o},o))}),!Object.keys(n.units).length&&!a&&e.jsx(T,{variant:"h4",style:{marginBottom:25},children:"Click the button to add your first unit!"}),!a&&e.jsx(mt,{color:"secondary",style:{marginLeft:25,marginBottom:25},onClick:()=>t(Hr()),"aria-label":"Add unit",children:e.jsx(mn,{})})]})},Ol=({onClose:t,showText:n})=>{const a=U(),[r,o]=M.useState([]),s=()=>Fe.keys().then(c=>o(c)),h=async c=>{try{const d=await Fe.getItem(c),f=sa(d);a(Gr({...f})),a(en()),a(ie(`${c} loaded!`,"success"))}catch{a(ie(`Could not load ${c}!`,"error"))}};return e.jsx(dn,{action:h,onOpen:s,options:r,title:"Choose List to load",text:"Load List",icon:e.jsx(Jr,{}),showText:n,onClose:t})},la=B.memo(Ol);var jn={},$l=W,Fl=L;Object.defineProperty(jn,"__esModule",{value:!0});var ca=jn.default=void 0,Bl=Fl(M),Wl=$l(H()),Ll=(0,Wl.default)(Bl.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");ca=jn.default=Ll;const Nl=({onClose:t,showText:n})=>{const a=U(),r=D(s=>s.roster),o=()=>{if(r.name==="New List"){a(ie("You have to give the list a name!","error"));return}Fe.setItem(r.name,{...ia(r)}).then(()=>a(ie("Saved!","success"))).catch(s=>{console.log(s),a(ie("Could not save!","error"))}).finally(()=>{t&&t()})};return e.jsxs(e.Fragment,{children:[e.jsx(ee,{title:"Save List",children:e.jsx(te,{color:"inherit","aria-label":"Save List",onClick:o,children:e.jsx(ca,{})})}),n&&e.jsx(T,{onClick:o,children:"Save List"})]})},ua=B.memo(Nl);var Sn={},zl=W,Hl=L;Object.defineProperty(Sn,"__esModule",{value:!0});var da=Sn.default=void 0,Ul=Hl(M),ql=zl(H()),Gl=(0,ql.default)(Ul.createElement("path",{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"}),"ColorLens");da=Sn.default=Gl;var wn={},Yl=W,Xl=L;Object.defineProperty(wn,"__esModule",{value:!0});var ha=wn.default=void 0,Ql=Xl(M),Jl=Yl(H()),Kl=(0,Jl.default)(Ql.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}),"Menu");ha=wn.default=Kl;var Cn={},Zl=W,ec=L;Object.defineProperty(Cn,"__esModule",{value:!0});var ma=Cn.default=void 0,tc=ec(M),nc=Zl(H()),rc=(0,nc.default)(tc.createElement("path",{d:"M12 .3a12 12 0 0 0-3.8 23.4c.6.1.8-.3.8-.6v-2c-3.3.7-4-1.6-4-1.6-.6-1.4-1.4-1.8-1.4-1.8-1-.7.1-.7.1-.7 1.2 0 1.9 1.2 1.9 1.2 1 1.8 2.8 1.3 3.5 1 0-.8.4-1.3.7-1.6-2.7-.3-5.5-1.3-5.5-6 0-1.2.5-2.3 1.3-3.1-.2-.4-.6-1.6 0-3.2 0 0 1-.3 3.4 1.2a11.5 11.5 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.6.2 2.8 0 3.2.9.8 1.3 1.9 1.3 3.2 0 4.6-2.8 5.6-5.5 5.9.5.4.9 1 .9 2.2v3.3c0 .3.1.7.8.6A12 12 0 0 0 12 .3"}),"GitHub");ma=Cn.default=rc;var Rn={},ac=W,oc=L;Object.defineProperty(Rn,"__esModule",{value:!0});var fa=Rn.default=void 0,ic=oc(M),sc=ac(H()),lc=(0,sc.default)(ic.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"}),"Info");fa=Rn.default=lc;const cc=({onClose:t=void 0})=>{const[n,a,r]=de(!1,void 0,t);return e.jsxs(e.Fragment,{children:[e.jsx(ee,{title:"Load List",children:e.jsx(te,{color:"inherit",onClick:a,children:e.jsx(fa,{})})}),e.jsx(T,{onClick:a,children:"About"}),e.jsxs(me,{open:n,onClose:r,children:[e.jsx(fe,{style:{textAlign:"center"},children:"About"}),e.jsxs(je,{children:[e.jsxs(T,{variant:"body1",children:["A simple Army Builder for the tabletop game"," ",e.jsx("a",{href:"https://ospreypublishing.com/xenos-rampant",children:"Xenos Rampant"}),"."]}),e.jsxs(E,{display:"flex",style:{marginTop:25},children:[e.jsx(qe,{label:"View on Github",icon:e.jsx(ma,{}),component:"a",href:"#chip",clickable:!0}),e.jsx(E,{flexGrow:1}),e.jsx(qe,{label:"License: MIT"})]})]})]})]})},uc=B.memo(cc);var _n={},dc=W,hc=L;Object.defineProperty(_n,"__esModule",{value:!0});var pa=_n.default=void 0,mc=hc(M),fc=dc(H()),pc=(0,fc.default)(mc.createElement("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"}),"Backup");pa=_n.default=pc;var Gt={},gc={get exports(){return Gt},set exports(t){Gt=t}};(function(t,n){(function(a,r){r()})(ke,function(){function a(f,v){return typeof v>"u"?v={autoBom:!1}:typeof v!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),v={autoBom:!v}),v.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(f.type)?new Blob(["\uFEFF",f],{type:f.type}):f}function r(f,v,y){var x=new XMLHttpRequest;x.open("GET",f),x.responseType="blob",x.onload=function(){d(x.response,v,y)},x.onerror=function(){console.error("could not download file")},x.send()}function o(f){var v=new XMLHttpRequest;v.open("HEAD",f,!1);try{v.send()}catch{}return 200<=v.status&&299>=v.status}function s(f){try{f.dispatchEvent(new MouseEvent("click"))}catch{var v=document.createEvent("MouseEvents");v.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),f.dispatchEvent(v)}}var h=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ke=="object"&&ke.global===ke?ke:void 0,c=h.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=h.saveAs||(typeof window!="object"||window!==h?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(f,v,y){var x=h.URL||h.webkitURL,R=document.createElement("a");v=v||f.name||"download",R.download=v,R.rel="noopener",typeof f=="string"?(R.href=f,R.origin===location.origin?s(R):o(R.href)?r(f,v,y):s(R,R.target="_blank")):(R.href=x.createObjectURL(f),setTimeout(function(){x.revokeObjectURL(R.href)},4e4),setTimeout(function(){s(R)},0))}:"msSaveOrOpenBlob"in navigator?function(f,v,y){if(v=v||f.name||"download",typeof f!="string")navigator.msSaveOrOpenBlob(a(f,y),v);else if(o(f))r(f,v,y);else{var x=document.createElement("a");x.href=f,x.target="_blank",setTimeout(function(){s(x)})}}:function(f,v,y,x){if(x=x||open("","_blank"),x&&(x.document.title=x.document.body.innerText="downloading..."),typeof f=="string")return r(f,v,y);var R=f.type==="application/octet-stream",I=/constructor/i.test(h.HTMLElement)||h.safari,$=/CriOS\/[\d]+/.test(navigator.userAgent);if(($||R&&I||c)&&typeof FileReader<"u"){var F=new FileReader;F.onloadend=function(){var Z=F.result;Z=$?Z:Z.replace(/^data:[^;]*;/,"data:attachment/file;"),x?x.location.href=Z:location=Z,x=null},F.readAsDataURL(f)}else{var Y=h.URL||h.webkitURL,P=Y.createObjectURL(f);x?x.location=P:location.href=P,x=null,setTimeout(function(){Y.revokeObjectURL(P)},4e4)}});h.saveAs=d.saveAs=d,t.exports=d})})(gc);const vc=({showText:t=!1,onClose:n=void 0})=>{const a=D(o=>o.data.customData),r=async()=>{const o={rosters:{},customData:a};await Fe.iterate((f,v)=>{o.rosters[v]=f});const s=new Blob([JSON.stringify(o)],{type:"text/plain;charset=utf-8"});let h=new Date;const c=h.getTimezoneOffset()*60*1e3;h=new Date(h.getTime()-c);const d=h.toISOString().slice(0,10).replace(/-/g,"/");Gt.saveAs(s,`${d}_DRAB.sav`),n&&n()};return e.jsxs(e.Fragment,{children:[e.jsx(ee,{title:"Backup",children:e.jsx(te,{color:"inherit",onClick:r,children:e.jsx(pa,{})})}),t&&e.jsx(T,{onClick:r,children:"Backup"})]})},yc=B.memo(vc);var kn={},xc=W,bc=L;Object.defineProperty(kn,"__esModule",{value:!0});var ga=kn.default=void 0,jc=bc(M),Sc=xc(H()),wc=(0,Sc.default)(jc.createElement("path",{d:"M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"}),"BrightnessHigh");ga=kn.default=wc;const Cc=({showText:t})=>{let n=D(s=>s.ui.darkMode);const a=D(s=>s.appState.autoDarkMode),r=U(),o=()=>{n===void 0&&(n=a),r(Ut({darkMode:!n}))};return e.jsxs(e.Fragment,{children:[e.jsx(ee,{title:"Dark Mode",children:e.jsx(te,{onClick:o,"aria-label":"Toggle Dark mode",children:e.jsx(ga,{color:n?"inherit":"disabled"})})}),t&&e.jsx(T,{color:n?"inherit":"textSecondary",onClick:o,children:"Dark Mode"})]})},Rc=B.memo(Cc);var An={},_c=W,kc=L;Object.defineProperty(An,"__esModule",{value:!0});var va=An.default=void 0,Ac=kc(M),Pc=_c(H()),Tc=(0,Pc.default)(Ac.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");va=An.default=Tc;const Ic=({onClose:t,showText:n})=>{const a=U(),[r,o]=M.useState([]),s=()=>Fe.keys().then(c=>o(c)),h=async c=>{await Fe.removeItem(c),a(ie("Deleted!","success"))};return e.jsx(dn,{action:h,onOpen:s,options:r,title:"Choose List to delete",text:"Delete List",icon:e.jsx(va,{}),showText:n,onClose:t})},Dc=B.memo(Ic);var Pn={},Mc=W,Ec=L;Object.defineProperty(Pn,"__esModule",{value:!0});var ya=Pn.default=void 0,Vc=Ec(M),Oc=Mc(H()),$c=(0,Oc.default)(Vc.createElement("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward");ya=Pn.default=$c;var Tn={},Fc=W,Bc=L;Object.defineProperty(Tn,"__esModule",{value:!0});var xa=Tn.default=void 0,Wc=Bc(M),Lc=Fc(H()),Nc=(0,Lc.default)(Wc.createElement("path",{d:"M3 21h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18V7H3v2zm0-6v2h18V3H3z"}),"FormatAlignJustify");xa=Tn.default=Nc;var In={},zc=W,Hc=L;Object.defineProperty(In,"__esModule",{value:!0});var ba=In.default=void 0,Uc=Hc(M),qc=zc(H()),Gc=(0,qc.default)(Uc.createElement("path",{d:"M15 15H3v2h12v-2zm0-8H3v2h12V7zM3 13h18v-2H3v2zm0 8h18v-2H3v2zM3 3v2h18V3H3z"}),"FormatAlignLeft");ba=In.default=Gc;var Dn={},Yc=W,Xc=L;Object.defineProperty(Dn,"__esModule",{value:!0});var Mn=Dn.default=void 0,Qc=Xc(M),Jc=Yc(H()),Kc=(0,Jc.default)(Qc.createElement("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"}),"Share");Mn=Dn.default=Kc;const ja=t=>navigator.clipboard.writeText(t),Zc=({onClose:t,showText:n})=>{const a=U(),r=D(x=>x.roster),o=D(x=>x.roster.units),s=()=>JSON.stringify(ia(r)),h=Ur(o),c=()=>{const x=[];x.push(`${r.name} @${h} points`),x.push("=====================================");for(const R of Object.values(r.units)){x.push(""),x.push(`${R.customName?R.customName+" ("+R.name+")":R.name} @${R.points} points`);const I=[...R.options,...R.xenosRules];if(I.length)for(const $ of I)x.push(`  - ${$}`)}return x.push(""),x.join(`
`)},d=()=>{const x=[];x.push(`**${r.name} --- ${h} points**`);for(const R of Object.values(r.units)){x.push(""),x.push(`* ${R.customName?R.customName+" ("+R.name+")":R.name} -- ${R.points} points`);const I=[...R.options,...R.xenosRules];if(I.length){x.push("");for(const $ of I)x.push(`    - ${$}`)}}return x.push(""),x.join(`
`)},f=[["As an importable String",e.jsx(ya,{})],["As text",e.jsx(ba,{})],["As markdown text",e.jsx(xa,{})]],v=[s,c,d],y=x=>{const R=v[f.reduce((I,$,F)=>$[0]===x?F:I,0)];try{const I=R();ja(I),a(ie("List copied to clipboard!","success"))}catch{a(ie("Could not export the list!","error"))}};return e.jsx(dn,{action:y,options:f,title:"Chose how to export",text:"Export",icon:e.jsx(Mn,{}),showText:n,onClose:t})},eu=B.memo(Zc);var En={},tu=W,nu=L;Object.defineProperty(En,"__esModule",{value:!0});var Vn=En.default=void 0,ru=nu(M),au=tu(H()),ou=(0,au.default)(ru.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"GetApp");Vn=En.default=ou;const iu=({onClose:t,showText:n})=>{const a=U(),r=o=>{if(o)try{const s=sa(JSON.parse(o));a(Gr({...s})),a(en()),a(ie("List imported!","success"))}catch{a(ie("Could not import the list!","error"))}};return e.jsx(aa,{anchor:e.jsxs(e.Fragment,{children:[e.jsx(ee,{title:"Import list",children:e.jsx(te,{color:"inherit","aria-label":"Import List",children:e.jsx(Vn,{})})}),n&&e.jsx(T,{children:"Import list"})]}),action:r,title:"Enter the import string",label:"Import String",okayText:"Import",onClose:t})},su=B.memo(iu);var On={},lu=W,cu=L;Object.defineProperty(On,"__esModule",{value:!0});var Sa=On.default=void 0,uu=cu(M),du=lu(H()),hu=(0,du.default)(uu.createElement("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm-2 16c-2.05 0-3.81-1.24-4.58-3h1.71c.63.9 1.68 1.5 2.87 1.5 1.93 0 3.5-1.57 3.5-3.5S13.93 9.5 12 9.5c-1.35 0-2.52.78-3.1 1.9l1.6 1.6h-4V9l1.3 1.3C8.69 8.92 10.23 8 12 8c2.76 0 5 2.24 5 5s-2.24 5-5 5z"}),"RestorePage");Sa=On.default=hu;const mu=({showText:t,onClose:n})=>{const a=U();let r;const o=B.useRef(null),s=async()=>{try{const d=r.result,f=JSON.parse(d);f.hasOwnProperty("rosters")&&(await Promise.all(Object.entries(f.rosters).map(([v,y])=>Fe.setItem(v,y))),a(nn(f.customData))),a(en()),a(ie("Restored!","success"))}catch(d){a(ie("Could not restore!","error")),console.log(d)}n&&n()},h=d=>{r=new FileReader,r.onloadend=s,d.target.files&&r.readAsText(d.target.files[0])},c=()=>{o.current&&o.current.click()};return e.jsxs(e.Fragment,{children:[e.jsx(ee,{title:"Backup",children:e.jsx(te,{color:"inherit",onClick:c,children:e.jsx(Sa,{})})}),t&&e.jsx(T,{onClick:c,children:"Restore"}),e.jsx("input",{type:"file",ref:o,style:{display:"none"},id:"restoreFile",accept:".sav",onChange:h})]})},fu=B.memo(mu),pu=()=>{const[t,n]=B.useState(!1),a=U(),r=()=>{a(Vr(!0)),n(!1)},o=h=>c=>{c.type==="keydown"&&(c.key==="Tab"||c.key==="Shift")||n(h)},s=M.useCallback(()=>n(!1),[]);return e.jsxs(e.Fragment,{children:[e.jsx(ha,{onClick:o(!0)}),e.jsx(Wo,{open:t,onClose:o(!1),children:e.jsxs(be,{children:[e.jsx(q,{button:!0,children:e.jsx(ua,{onClose:s,showText:!0})},"Save"),e.jsx(q,{button:!0,children:e.jsx(la,{onClose:s,showText:!0})},"Load"),e.jsx(q,{button:!0,children:e.jsx(Dc,{onClose:s,showText:!0})},"Delete"),e.jsx(ut,{}),e.jsx(q,{button:!0,children:e.jsx(eu,{onClose:s,showText:!0})},"Export"),e.jsx(q,{button:!0,children:e.jsx(su,{onClose:s,showText:!0})},"Import"),e.jsx(ut,{}),e.jsx(q,{button:!0,children:e.jsx(yc,{onClose:s,showText:!0})},"Backup"),e.jsx(q,{button:!0,children:e.jsx(fu,{onClose:s,showText:!0})},"Restore"),e.jsx(ut,{}),e.jsxs(q,{button:!0,children:[e.jsx(ee,{title:"Customize",children:e.jsx(te,{color:"inherit",onClick:r,children:e.jsx(da,{})})}),e.jsx(T,{onClick:r,children:"Customize"})]},"FR"),e.jsx(ut,{}),e.jsx(q,{button:!0,children:e.jsx(Qr,{showText:!0})},"InlineRules"),e.jsx(q,{button:!0,children:e.jsx(Rc,{showText:!0})},"DarkMode"),e.jsx(q,{button:!0,children:e.jsx(uc,{onClose:s})},"About")]})})]})},gu=B.memo(pu),Sr=({option:t,Icon:n,title:a})=>{const r=D(h=>h.ui[t]),o=U(),s=()=>{const h=t==="viewMode"?"editMode":"viewMode";o(Ut(r?{[t]:!r}:{[t]:!r,[h]:!1}))};return e.jsx(ee,{title:a,children:e.jsx(te,{color:"inherit","aria-label":a,onClick:s,children:e.jsx(n,{fontSize:"small",color:r?"inherit":"disabled"})})})},vu=()=>{const t=D(a=>a.roster.units),n=Ur(t);return e.jsxs(e.Fragment,{children:[e.jsx(Ae,{smDown:!0,children:e.jsxs(T,{variant:"h4",children:["    Total Points  ",e.jsx(mt,{color:"secondary",size:"small",children:e.jsx(T,{variant:"h4",children:n})})]})}),e.jsx(Ae,{mdUp:!0,children:e.jsxs(T,{variant:"h4",children:["    ",e.jsx(mt,{color:"secondary",size:"small",children:e.jsx(T,{variant:"h4",children:n})})]})})]})},yu=()=>{const t=U();return e.jsxs(E,{display:"flex",children:[e.jsx(Lo,{position:"fixed",children:e.jsxs(fr,{children:[e.jsxs(E,{display:"flex",alignItems:"center",children:[e.jsx(gu,{}),e.jsx(Ae,{smDown:!0,children:e.jsx(T,{variant:"h3",children:"  Xenos Rampant Army Builder  "})}),e.jsx(Ae,{xsDown:!0,mdUp:!0,children:e.jsx(T,{variant:"h3",children:"  XRAB  "})}),e.jsx(te,{color:"inherit","aria-label":"reload",onClick:()=>t(os()),children:e.jsx(Nr,{})}),e.jsx(ua,{}),e.jsx(la,{})]}),e.jsx(E,{flexGrow:1}),e.jsxs(E,{display:"flex",alignItems:"center",children:[e.jsx(Sr,{option:"viewMode",Icon:zr,title:"View mode"}),e.jsx(Sr,{option:"editMode",Icon:an,title:"Edit mode"}),e.jsx(Ae,{smDown:!0,children:e.jsx(Qr,{})}),e.jsx(vu,{})]})]})}),e.jsx(fr,{})]})};function oe({validation:t={},parseError:n,type:a,required:r,name:o,customError:s,...h}){return r&&(t.required="This field is required"),a==="email"&&(t.pattern={value:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,message:"Please enter a valid email address"}),e.jsx(Zt,{name:o,rules:t,render:({field:{value:c,onChange:d,onBlur:f},fieldState:{invalid:v,error:y}})=>e.jsx(Ze,{...h,name:o,value:c??"",onChange:d,onBlur:f,required:r,type:a,error:v||(typeof s=="function"?s(c):!1),helperText:y?typeof n=="function"?n(y):y.message:h.helperText})})}const xu=({defaultValues:t={},onSuccess:n=()=>{},FormProps:a,children:r})=>{const o=_t({defaultValues:t}),{handleSubmit:s}=o;return e.jsx(Nt,{...o,children:e.jsx("form",{onSubmit:s(n),noValidate:!0,...a,children:r})})},Ye=t=>!t.formContext&&!t.handleSubmit?e.jsx(xu,{...t}):t.handleSubmit&&t.formContext?e.jsx(Nt,{...t.formContext,children:e.jsx("form",{noValidate:!0,...t.FormProps,onSubmit:t.handleSubmit,children:t.children})}):t.formContext&&t.onSuccess?e.jsx(Nt,{...t.formContext,children:e.jsx("form",{onSubmit:t.formContext.handleSubmit(t.onSuccess),noValidate:!0,...t.FormProps,children:t.children})}):e.jsx("div",{children:"Incomplete setup of FormContainer.."});function Be({name:t,required:n,valueKey:a="",labelKey:r="",options:o=[],parseError:s,type:h,objectOnChange:c,validation:d={},...f}){var x;const v=!!((x=f.SelectProps)!=null&&x.native),y=v?"option":Ct;return n&&(d.required="This field is required"),e.jsx(Zt,{name:t,rules:d,render:({field:{onBlur:R,onChange:I,value:$},fieldState:{invalid:F,error:Y}})=>(h==="number"&&$&&(f.InputLabelProps=f.InputLabelProps||{},f.InputLabelProps.shrink=!0),typeof $=="object"&&($=$[a]),e.jsxs(Ze,{...f,name:t,value:$||"",onBlur:R,onChange:P=>{let Z=P.target.value;h==="number"&&(Z=Number(Z)),I(Z),typeof f.onChange=="function"&&(c&&(Z=o.find(se=>se[a]===Z)),f.onChange(Z))},select:!0,required:n,error:F,helperText:Y?typeof s=="function"?s(Y):Y.message:f.helperText,children:[v&&e.jsx("option",{}),o.map(P=>M.createElement(y,{key:`${t}_${a?P[a]:P}`,value:a?P[a]:P},r?P[r]:P))]}))})}$e({root:{color:Kt[400]}});var $n={},bu=W,ju=L;Object.defineProperty($n,"__esModule",{value:!0});var wa=$n.default=void 0,Su=ju(M),wu=bu(H()),Cu=(0,wu.default)(Su.createElement("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");wa=$n.default=Cu;const Ru=48,_u=8;function Ke({menuItems:t,label:n="",valueKey:a="",labelKey:r="",required:o=!1,validation:s={},parseError:h,name:c,menuMaxHeight:d=Ru*4.5+_u,menuMaxWidth:f=250,minWidth:v=120,helperText:y,showChips:x,variant:R,...I}){return o&&(s.required="This field is required"),e.jsx(Zt,{name:c,rules:s,render:({field:{value:$,onChange:F,onBlur:Y},fieldState:{invalid:P,error:Z}})=>(y=Z?typeof h=="function"?h(Z):Z.message:y,e.jsxs(Pe,{variant:R,style:{minWidth:v},fullWidth:I.fullWidth,error:P,children:[e.jsx(Rt,{error:P,htmlFor:I.id||`select-multi-select-${c}`,required:o,children:n}),e.jsx(Ge,{...I,id:I.id||`select-multi-select-${c}`,label:n,multiple:!0,error:P,value:$||[],required:o,onChange:F,onBlur:Y,MenuProps:{PaperProps:{style:{maxHeight:d,width:f}}},renderValue:x?se=>e.jsx("div",{style:{display:"flex",flexWrap:"wrap"},children:(se||[]).map(k=>e.jsx(qe,{label:k,style:{display:"flex",flexWrap:"wrap"},onDelete:()=>{F($.filter(N=>N!==k))},deleteIcon:e.jsx(wa,{onMouseDown:N=>{N.stopPropagation()}})},k))}):void 0,children:t.map(se=>e.jsx(Ct,{value:a?se[a]:se,style:{fontWeight:($||[]).includes(se)?"bold":"normal"},children:r?se[r]:se},`${c}_${a?se[a]:se}`))}),y&&e.jsx(No,{children:y})]}))})}$e({root:{color:Kt[400]}});var Fn=function(t,n,a){return n===void 0&&(n={}),a===void 0&&(a={}),function(r,o,s){try{return Promise.resolve(function(h,c){try{var d=(n.context,Promise.resolve(t[a.mode==="sync"?"validateSync":"validate"](r,Object.assign({abortEarly:!1},n,{context:o}))).then(function(f){return s.shouldUseNativeValidation&&ri({},s),{values:a.raw?r:f,errors:{}}}))}catch(f){return c(f)}return d&&d.then?d.then(void 0,c):d}(0,function(h){if(!h.inner)throw h;return{values:{},errors:ai((c=h,d=!s.shouldUseNativeValidation&&s.criteriaMode==="all",(c.inner||[]).reduce(function(f,v){if(f[v.path]||(f[v.path]={message:v.message,type:v.type}),d){var y=f[v.path].types,x=y&&y[v.type];f[v.path]=oi(v.path,d,f,v.type,x?[].concat(x,v.message):v.message)}return f},{})),s)};var c,d}))}catch(h){return Promise.reject(h)}}};const wr=t=>t||{enemy:"",victoryPoints:0,enemyVictoryPoints:0,careerPointsGained:0,date:new Date().toISOString().slice(0,10).replace(/-/g,"-")},ku=Te({enemy:K(),victoryPoints:Q().min(0).integer().required(),enemyVictoryPoints:Q().min(0).integer().required(),careerPointsGained:Q().integer().required(),date:K()}),Au=(t,n,a,r)=>{const o=_t({resolver:Fn(ku),defaultValues:{...wr(r)}}),{reset:s}=o;return M.useEffect(()=>{n&&s({...wr(r)})},[s,n,r]),[o,c=>{t(c),a()}]},Ca=({title:t,onSubmit:n,open:a,handleClose:r,initialBattle:o})=>{const[s,h]=Au(n,a,r,o);return e.jsxs(me,{onClose:r,open:a,children:[e.jsx(fe,{children:t}),e.jsxs(Ye,{formContext:s,onSuccess:h,children:[e.jsxs(je,{children:[e.jsx(oe,{name:"date",label:"Date",type:"date"}),e.jsx(oe,{name:"enemy",label:"enemy",type:"text",fullWidth:!0}),e.jsx(oe,{name:"enemyVictoryPoints",label:"Enemy victory points",type:"number",fullWidth:!0}),e.jsx(oe,{name:"victoryPoints",label:"Victory points",type:"number",fullWidth:!0}),e.jsx(oe,{name:"careerPointsGained",label:"Career points",type:"number",fullWidth:!0})]}),e.jsxs(Se,{children:[e.jsx(z,{onClick:r,color:"primary",children:"Cancel"}),e.jsx(z,{type:"submit",color:"primary",children:"Okay"})]})]})]})},Pu=()=>{const t=U(),[n,a,r]=de();return e.jsxs(E,{marginTop:"20px",children:[e.jsx(z,{onClick:a,variant:"contained",color:"secondary",children:"Add battle"}),e.jsx(Ca,{title:"New Battle",onSubmit:o=>t(gs(o)),open:n,handleClose:r})]})},Tu=$e(t=>({icon:{color:t.palette.secondary.contrastText}})),Iu=({battleSelection:t})=>{const n=D(c=>{var d;return(d=c.roster.campaign)==null?void 0:d.commanders[t.commanderIndex].battles[t.battleIndex]}),a=U(),r=Tu(),[o,s,h]=de();return e.jsxs(e.Fragment,{children:[e.jsx(te,{onClick:s,children:e.jsx(Ar,{className:r.icon})}),e.jsx(Ca,{title:"Edit Battle",onSubmit:c=>a(vs(c,t)),open:o,handleClose:h,initialBattle:n})]})},ze=zo(t=>Ho({head:{backgroundColor:t.palette.primary.main,color:t.palette.primary.contrastText}}))(ne),Du=$e(t=>({win:{backgroundColor:Uo[100],color:t.palette.common.black},defeat:{backgroundColor:Kt[100],color:t.palette.common.black},draw:{backgroundColor:t.palette.grey[100],color:t.palette.common.black},selected:{backgroundColor:t.palette.secondary.light},selectionMenu:{backgroundColor:t.palette.secondary.main,color:t.palette.secondary.contrastText,paddingLeft:"20px",width:"100%",display:"flex",alignItems:"center",gap:"20px"},selectionMenuIcon:{color:t.palette.secondary.contrastText}})),Mu=()=>{const t=U(),n=Du(),[a,r]=D(f=>as(f)),[o,s]=B.useState(-1),h=Jt(),c=yt(h.breakpoints.down("xs")),d=(f,v,y)=>f?n.selected:y>v?n.win:y<v?n.defeat:n.draw;return a.length===0?e.jsx(e.Fragment,{}):e.jsxs(jt,{component:E,marginTop:"20px",children:[o>=0&&e.jsxs(E,{className:n.selectionMenu,children:[e.jsx(T,{children:"Actions"}),e.jsx(E,{flexGrow:1}),e.jsx(te,{onClick:()=>{t(ys({commanderIndex:r[o].commanderIndex,battleIndex:r[o].battleIndex})),s(-1)},children:e.jsx(qo,{className:n.selectionMenuIcon})}),e.jsx(Iu,{battleSelection:{commanderIndex:r[o].commanderIndex,battleIndex:r[o].battleIndex}})]}),e.jsxs(St,{"aria-label":"battles table",size:c?"small":"medium",children:[o<0&&e.jsx(Pr,{children:e.jsxs(he,{children:[!c&&e.jsx(ze,{children:"Date"}),!c&&e.jsx(ze,{children:"Commander"}),e.jsx(ze,{children:"Enemy"}),!c&&e.jsx(ze,{children:"Enemy VP"}),e.jsx(ze,{children:"VP"}),e.jsx(ze,{children:"CP"})]})}),e.jsx(wt,{children:a.map((f,v)=>{const y=d(v===o,f.enemyVictoryPoints,f.victoryPoints);return e.jsxs(he,{onClick:()=>s(o===v?-1:v),selected:v===o,children:[!c&&e.jsx(ne,{className:y,component:"th",scope:"row",children:f.date}),!c&&e.jsx(ne,{className:y,children:f.commander}),e.jsx(ne,{className:y,children:f.enemy}),!c&&e.jsx(ne,{className:y,children:f.enemyVictoryPoints}),e.jsx(ne,{className:y,children:f.victoryPoints}),e.jsx(ne,{className:y,children:f.careerPointsGained})]},f.date+f.enemy+f.victoryPoints+v)})})]})]})},Eu=()=>e.jsxs(E,{marginTop:"20px",children:[e.jsx(T,{variant:"h4",children:"Battles"}),e.jsx(Pu,{}),e.jsx(Mu,{})]}),Vu=(t,n)=>{let a=t.battles.reduce((r,o)=>r+o.careerPointsGained,t.initialCareerPoints);if(a+=t.careerPointAdjustment,a-=t.commanderTraits.length*5,t.commanderTraits.length>0){const r=new Set;t.commanderTraits.forEach(o=>r.add(n[o].category)),a+=10-r.size*5}return a-=t.removedCommanderTraits.length*10,a-=t.detachmentExpansions*10,a},Ou=({commander:t})=>{const n=U(),a=D(y=>y.data.traitData),[r,o]=B.useState("0"),[s,h,c]=de(!1,()=>o(String(t.careerPointAdjustment))),d=Vu(t,a),f=()=>!isNaN(Number(r)),v=()=>{n(ds(Number(r))),c()};return e.jsxs(e.Fragment,{children:[e.jsx(qe,{label:"Career Points ",color:"primary",icon:e.jsx(T,{children:d}),onDelete:h,deleteIcon:e.jsx(Ar,{})}),e.jsxs(me,{onClose:c,open:s,children:[e.jsx(fe,{children:"Set career point adjustment"}),e.jsx(je,{children:e.jsx(Ze,{id:"enemyvp",label:"Enemy victory points",error:!f(),type:"text",margin:"normal",fullWidth:!0,value:r,onChange:y=>o(y.target.value)})}),e.jsxs(Se,{children:[e.jsx(z,{onClick:c,color:"primary",children:"Cancel"}),e.jsx(z,{onClick:v,color:"primary",disabled:!f(),children:"Okay"})]})]})]})},$u=B.memo(Ou),Fu=()=>{const[t,n]=B.useState(null),[a,r]=B.useState(""),[o,s]=B.useState("Confirm action"),h=(y,x)=>new Promise(R=>{y&&r(y),x&&s(x),n({resolve:R})}),c=()=>{n(null)},d=()=>{t==null||t.resolve(!0),c()},f=()=>{t==null||t.resolve(!1),c()};return[()=>e.jsxs(me,{open:t!==null,children:[e.jsx(fe,{children:o}),e.jsx(je,{children:e.jsx(Go,{children:a})}),e.jsxs(Se,{children:[e.jsx(z,{onClick:d,children:"Okay"}),e.jsx(z,{onClick:f,children:"Cancel"})]})]}),h]},Bu=()=>{const t=U(),[n,a]=Fu(),r=async()=>{await a("Killing a commander is permanent!")&&t(br())},o=async()=>{await a("Retiring a commander is permanent!")&&(t(ps()),t(br()))};return e.jsxs(E,{display:"flex",justifyContent:"flex-end",textAlign:"center",children:[e.jsx(z,{color:"secondary",size:"small",variant:"outlined",onClick:o,"aria-label":"Kill commander",style:{marginRight:20},children:"Retire"}),e.jsx(z,{color:"secondary",size:"small",variant:"outlined",onClick:r,"aria-label":"Kill commander",children:"Kill"}),e.jsx(n,{})]})},Wu=(t,n,a)=>{const r=[];let o="";return Object.values(t).map(s=>{var c,d;const h=s.name;s.category!==o&&(o=s.category,r.push(e.jsx(Xo,{disableSticky:!0,children:e.jsx(T,{color:"secondary",variant:"overline",children:o})},h+"header"))),r.push(e.jsx(q,{value:h,dense:!0,style:{maxWidth:400},children:e.jsx(ee,{title:s.description,children:e.jsx(ue,{primary:h,secondary:a&&(((c=t[h])==null?void 0:c.short)||((d=t[h])==null?void 0:d.description))||"",primaryTypographyProps:{variant:"body2",color:n.commanderTraits.indexOf(h)>-1?"primary":"inherit"},style:{margin:0}})})},h))}),r},Lu=({commander:t,traitData:n})=>{const a=U(),[r,o,s]=de(),h=D(d=>d.ui.inlineRules),c=d=>a(ms([...d.target.value]));return e.jsxs(E,{textAlign:"center",children:[e.jsx(T,{variant:"subtitle2",style:{marginTop:5},children:"Add traits"}),e.jsx(te,{onClick:o,children:e.jsx(Yo,{})}),e.jsx(Pe,{style:{marginTop:0,width:0,height:0},children:e.jsx(Ge,{open:r,onClose:s,onOpen:o,IconComponent:()=>e.jsx(E,{}),multiple:!0,value:t.commanderTraits,onChange:c,input:e.jsx(et,{}),renderValue:()=>" ",children:Wu(n,t,h)})})]})};var Bn={},Nu=W,zu=L;Object.defineProperty(Bn,"__esModule",{value:!0});var Ra=Bn.default=void 0,Hu=zu(M),Uu=Nu(H()),qu=(0,Uu.default)(Hu.createElement("path",{d:"M19 13H5v-2h14v2z"}),"Remove");Ra=Bn.default=qu;const Gu=({commander:t})=>{const n=U();return e.jsxs(E,{textAlign:"center",children:[e.jsx(T,{variant:"subtitle2",style:{marginTop:10},children:"Expand detachment"}),e.jsxs(E,{display:"flex",justifyContent:"center",alignItems:"center",children:[e.jsx(te,{onClick:()=>n(jr(-1)),children:e.jsx(Ra,{})}),e.jsx(T,{variant:"body1",children:t.detachmentExpansions}),e.jsx(te,{onClick:()=>n(jr(1)),children:e.jsx(mn,{})})]})]})},Yu=({commander:t,traitData:n})=>{const a=U(),[r,o,s]=de(),h=c=>a(fs([...c.target.value]));return e.jsxs(E,{textAlign:"center",children:[e.jsx(T,{variant:"subtitle2",style:{marginTop:5},children:"Remove traits"}),e.jsx(te,{onClick:o,children:e.jsx(Qo,{})}),e.jsx(Pe,{style:{marginTop:0,width:0,height:0},children:e.jsx(Ge,{open:r,onClose:s,onOpen:o,IconComponent:()=>e.jsx(E,{}),multiple:!0,value:t.removedCommanderTraits,onChange:h,input:e.jsx(et,{}),renderValue:()=>" ",children:t.commanderTraits.map(c=>e.jsx(Ct,{value:n[c].name,children:e.jsx(ee,{title:n[c].description,children:e.jsx(T,{color:t.removedCommanderTraits.indexOf(n[c].name)>-1?"primary":"inherit",children:n[c].name},n[c].name+"menutypo")},n[c].name)},n[c].name+"menuitem"))})})]})},Xu=({commander:t,traitData:n})=>e.jsxs(e.Fragment,{children:[e.jsx(T,{variant:"subtitle1",children:"Spend career points"}),e.jsxs(E,{display:"flex",justifyContent:"space-evenly",children:[e.jsx(Lu,{commander:t,traitData:n}),e.jsx(Yu,{commander:t,traitData:n}),e.jsx(Gu,{commander:t})]})]}),Qu=({commander:t,traitData:n})=>{const a=t.commanderTraits.filter(o=>!t.removedCommanderTraits.includes(o)),r=D(o=>o.ui.inlineRules);return e.jsxs(e.Fragment,{children:[e.jsx(T,{variant:"subtitle1",children:"Traits"}),e.jsx(be,{dense:!0,children:a.map(o=>{var s,h;return e.jsx(ee,{title:n[o].description,children:e.jsx(q,{children:e.jsx(ue,{primary:o,secondary:r&&(((s=n[o])==null?void 0:s.short)||((h=n[o])==null?void 0:h.description))||"",primaryTypographyProps:{variant:"body2"},style:{margin:0}})},o)},o)})})]})},Ju=$e(t=>({commanderName:{backgroundColor:t.palette.background.paper,color:t.palette.text.primary,border:0}})),Ku=({currentCommander:t})=>{const n=U(),a=Ju(),r=D(o=>o.data.traitData);return e.jsxs(Rr,{style:{marginTop:20},children:[e.jsx(Lt,{title:e.jsxs(E,{display:"flex",flexWrap:"wrap",children:[e.jsx(Pe,{children:e.jsx(T,{className:a.commanderName,"aria-label":"Commander name",variant:"h4",component:"input",value:t.name,onChange:o=>n(hs(o.target.value))},"currentCommanderName")}),e.jsx(E,{flexGrow:1}),e.jsx($u,{commander:t})]})}),e.jsxs(kr,{style:{marginLeft:20},children:[e.jsx(Qu,{commander:t,traitData:r}),e.jsxs(T,{variant:"subtitle1",style:{marginBottom:20},children:["Extra detachment size:"," ",e.jsx("strong",{children:t.detachmentExpansions*2})]}),e.jsx(Xu,{commander:t,traitData:r}),e.jsx(Bu,{})]})]})},Zu=B.memo(Ku),ed=()=>{const t=U(),n=D(o=>o.ui.campaignExpanded),a=D(o=>qr(o)),r=D(o=>rs(o));return e.jsxs(tt,{expanded:n,onChange:()=>t(ot("campaignExpanded")),style:{maxWidth:1210,marginBottom:20},children:[e.jsx(nt,{expandIcon:e.jsx(Ee,{}),children:e.jsx(T,{variant:"h3",children:"Campaign"})}),e.jsx(rt,{style:{marginLeft:20,marginRight:20},children:a?e.jsxs(E,{maxWidth:"1210",marginBottom:"20px",width:"100%",children:[e.jsxs(T,{variant:"h4",align:"right",children:["Victory Points  ",e.jsx(mt,{color:"secondary",size:"small",children:e.jsx(T,{variant:"body1",children:r})})]}),e.jsx(Zu,{currentCommander:a}),e.jsx(Eu,{})]}):e.jsx(z,{color:"primary",variant:"contained",onClick:()=>t(us()),"aria-label":"Start a campaign",children:"Start a campaign!"})})]})},ht=({data:t,setData:n,customData:a,label:r,type:o})=>{const s=h=>c=>{c.target.checked?n(Ue(t,d=>{d[h][c.target.name]=a[h][c.target.name]})):n(Ue(t,d=>{delete d[h][c.target.name]}))};return e.jsx(e.Fragment,{children:Object.keys(a[o]).length!==0&&e.jsxs(e.Fragment,{children:[e.jsx(bt,{children:r}),e.jsx(Jo,{children:Object.keys(a[o]).map(h=>e.jsx(Xt,{control:e.jsx(Qt,{checked:t[o][h]!==void 0,onChange:s(o),name:h}),label:h},h))})]})})},td=({open:t,handleClose:n})=>{const[a,r]=B.useState(pt()),o=ge(x=>x.data.customData),s=Ve(),h=()=>r(o),c=()=>r(pt()),d=Object.values(a).every(x=>Object.keys(x).length===0),f=Object.values(o).some(x=>Object.keys(x).length!==0),v=()=>{try{const x=JSON.stringify(a);ja(x),s(ie("Custom data copied to clipboard!","success")),n()}catch{s(ie("Could not export the custom data!","error"))}},y={data:a,setData:r,customData:o};return e.jsxs(me,{onClose:n,open:t,children:[e.jsx(fe,{children:"Export custom data"}),e.jsx(je,{children:e.jsxs(Pe,{children:[f&&e.jsx(E,{mb:1,children:e.jsxs(Tr,{size:"small",color:"primary",variant:"text",children:[e.jsx(z,{onClick:h,children:"Select all"}),e.jsx(z,{onClick:c,children:"Select none"})]})}),e.jsx(ht,{label:"Units",type:"unitData",...y}),e.jsx(ht,{label:"Rules",type:"rulesData",...y}),e.jsx(ht,{label:"Xenos Rules",type:"xenosRulesData",...y}),e.jsx(ht,{label:"Psychic Powers",type:"psychicPowers",...y})]})}),e.jsxs(Se,{children:[e.jsx(z,{onClick:n,color:"primary",children:"Cancel"}),e.jsx(z,{onClick:v,disabled:d,color:"primary",children:"Export"})]})]})},nd=({open:t,handleClose:n})=>{const a=Ve(),[r,o]=B.useState(""),s=()=>{if(!r){a(ie("You have to input some data!","error"));return}try{const d=JSON.parse(r);a(nn(d)),a(ie("Custom data imported!","success"))}catch{a(ie("Could not import the custom data!","error"))}},h=d=>{d==="Enter"?c():d==="ESC"&&n()},c=()=>{s(),n()};return e.jsxs(me,{onClose:n,open:t,children:[e.jsx(fe,{children:"Enter the import string"}),e.jsx(je,{children:e.jsx(Ze,{autoFocus:!0,margin:"normal",label:"Import String",type:"text",fullWidth:!0,onChange:d=>o(d.target.value),onKeyPress:d=>h(d.key)})}),e.jsxs(Se,{children:[e.jsx(z,{onClick:n,color:"primary",children:"Cancel"}),e.jsx(z,{onClick:c,disabled:!r,color:"primary",children:"Import"})]})]})},rd=B.memo(nd);var Wn={},ad=W,od=L;Object.defineProperty(Wn,"__esModule",{value:!0});var Ln=Wn.default=void 0,id=od(M),sd=ad(H()),ld=(0,sd.default)(id.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"}),"AddCircle");Ln=Wn.default=ld;var Nn={},cd=W,ud=L;Object.defineProperty(Nn,"__esModule",{value:!0});var zn=Nn.default=void 0,dd=ud(M),hd=cd(H()),md=(0,hd.default)(dd.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteForever");zn=Nn.default=md;const _a=({data:t,actionOneName:n="Edit",ActionOneIcon:a=an,handleClickActionOne:r,actionTwoName:o="Delete",ActionTwoIcon:s=zn,handleClickActionTwo:h,actionSpecialName:c="Add new",ActionSpecialIcon:d=Ln,handleClickSpecialAction:f})=>e.jsxs(be,{children:[Object.keys(t).map(v=>e.jsxs(q,{id:v,children:[e.jsx(Yt,{children:e.jsx(te,{"aria-label":n,onClick:()=>r(v),children:e.jsx(a,{color:"primary"})})}),e.jsx(ue,{children:v}),e.jsx(Ir,{children:e.jsx(te,{size:"small","aria-label":o,onClick:()=>h(v),children:e.jsx(s,{color:"action"})})})]},v)),e.jsx(q,{id:"add_fr",children:e.jsx(z,{"aria-label":c,startIcon:e.jsx(d,{color:"secondary"}),onClick:f,children:c})},"add_fr")]});function fd(t){const{data:n,CustomForm:a,schema:r,emptyState:o,removeFunc:s,addFunc:h}=t,[c,d]=M.useState(""),[f,v,y]=de(),x=_t({resolver:Fn(r)}),{reset:R}=x,I=P=>P!==""&&Object.keys(n).every(Z=>Z===c||Z!==P),$=P=>{P.name!==c&&s(c),I(P.name)&&(h(P),y())},F=P=>{R({...n[P]}),d(P),v()},Y=()=>{R({...o}),d(""),v()};return e.jsxs(e.Fragment,{children:[e.jsx(_a,{data:n,handleClickActionOne:F,handleClickActionTwo:s,handleClickSpecialAction:Y}),e.jsx(a,{formContext:x,open:f,handleClose:y,handleAction:$,validateName:I})]})}function Pt(t){const{name:n,id:a,expanded:r,handleChange:o,data:s,CustomForm:h,schema:c,emptyState:d,removeFunc:f,addFunc:v}=t;return e.jsxs(tt,{expanded:r===n,onChange:o(n),children:[e.jsx(nt,{expandIcon:e.jsx(Ee,{}),"aria-controls":a+"-content",id:a+"-header",children:e.jsxs(T,{children:["Manage ",n]})}),e.jsx(rt,{children:e.jsx(fd,{data:s,CustomForm:h,schema:c,emptyState:d,removeFunc:f,addFunc:v})})]})}function pd(t){const{formContext:n,open:a,handleClose:r,handleAction:o,validateName:s}=t;return e.jsx(me,{open:a,children:e.jsxs(Ye,{formContext:n,onSuccess:o,children:[e.jsx(fe,{children:"Psychic Power"}),e.jsxs(je,{children:[e.jsx(oe,{name:"name",label:"Name",type:"text",margin:"normal",fullWidth:!0,customError:h=>!s(h)}),e.jsx(Be,{name:"difficulty",label:"Difficulty",type:"number",margin:"normal",fullWidth:!0,options:le(2,12)}),e.jsx(oe,{name:"target",label:"Target",type:"text",margin:"normal",fullWidth:!0}),e.jsx(oe,{name:"duration",label:"Duration",type:"text",margin:"normal",fullWidth:!0}),e.jsx(oe,{name:"effect",label:"Effekt",type:"text",margin:"normal",fullWidth:!0,multiline:!0}),e.jsx(oe,{name:"short",label:"Short description",type:"text",margin:"normal",fullWidth:!0,multiline:!0})]}),e.jsxs(Se,{children:[e.jsx(z,{onClick:r,color:"primary",children:"Cancel"}),e.jsx(z,{type:"submit",color:"primary",children:"Okay"})]})]})})}const gd=Te({name:K().min(1).required(),difficulty:Q().min(2).max(12),target:K(),duration:K(),effect:K(),short:K()}),vd={name:"Name",difficulty:7,target:"Target",duration:"Duration",effect:"Effekt"};function yd(t){const{expanded:n,handleChange:a}=t,r=Ve(),o=ge(c=>c.data.customData.psychicPowers),s=c=>r(Pi(c)),h=c=>r(Ai(c));return e.jsx(Pt,{name:"Psychic Powers",id:"spells",expanded:n,handleChange:a,data:o,CustomForm:pd,schema:gd,emptyState:{...vd},removeFunc:s,addFunc:h})}const xd=B.memo(yd);function bd(t){const{formContext:n,open:a,handleClose:r,handleAction:o,validateName:s}=t;return e.jsx(me,{open:a,children:e.jsxs(Ye,{formContext:n,onSuccess:o,children:[e.jsx(fe,{children:"Rule"}),e.jsxs(je,{children:[e.jsx(oe,{name:"name",label:"Name",type:"text",margin:"normal",fullWidth:!0,customError:h=>!s(h)}),e.jsx(oe,{name:"description",label:"Description",type:"text",margin:"normal",fullWidth:!0,multiline:!0}),e.jsx(oe,{name:"short",label:"Short description",type:"text",margin:"normal",fullWidth:!0,multiline:!0})]}),e.jsxs(Se,{children:[e.jsx(z,{onClick:r,color:"primary",children:"Cancel"}),e.jsx(z,{type:"submit",color:"primary",children:"Okay"})]})]})})}const jd=Te({name:K().min(1).required(),description:K(),short:K()}),Sd={name:"Name",description:"Description"};function wd(t){const{expanded:n,handleChange:a}=t,r=Ve(),o=ge(d=>d.data.customData),s=ge(d=>d.roster.units),h=d=>{Object.values(s).some(f=>f.rules.includes(d))||Object.values(o.unitData).some(f=>f.rules.includes(d))?r(ie("You can't delete a rule currently in use!","error")):r(Ii(d))},c=d=>r(Ti(d));return e.jsx(Pt,{name:"Rules",id:"rules",expanded:n,handleChange:a,data:o.rulesData,CustomForm:bd,schema:jd,emptyState:{...Sd},removeFunc:h,addFunc:c})}const Cd=B.memo(wd),Rd=()=>{const[t,n]=B.useState(null);return[t,o=>{n(o.currentTarget)},()=>{n(null)}]},gt=({title:t,type:n,watch:a,setValue:r})=>{const[o,s,h]=Rd(),c=n==="setStats"?"range":"adjustRange";return e.jsxs(e.Fragment,{children:[e.jsx(Rt,{id:"options-label",style:{marginTop:15},children:t}),e.jsxs(be,{children:[Object.keys(a(n)||{}).map(d=>e.jsxs(q,{id:d,children:[e.jsx(Be,{name:n+"."+d,label:He[d].name,type:"number",fullWidth:!0,options:He[d][c]}),e.jsx(Ir,{children:e.jsx(te,{size:"small","aria-label":"Delete",onClick:()=>r(n,Ue(a(n),f=>{f&&delete f[d]})),children:e.jsx(zn,{color:"action"})})})]},d)),e.jsxs(q,{id:"add_opt",children:[e.jsx(z,{onClick:s,startIcon:e.jsx(Ln,{}),children:"Add Stat"}),e.jsx(Ko,{id:"add-stat-menu",anchorEl:o,keepMounted:!0,open:!!o,onClose:h,children:Object.keys(He).filter(d=>!Object.keys(a(n)||{}).includes(d)).map(d=>e.jsx(Ct,{onClick:()=>r(n,{...a(n),[d]:n==="setStats"?4:0}),children:He[d].name},d))})]},"add_opt")]})]})},_d=t=>ii(n=>Te(kd(n,t))),kd=(t,n)=>Object.keys(t).reduce((a,r)=>({...a,[r]:n}),{}),Hn=Te({attack:Q().min(2).max(12),move:Q().min(2).max(12),shoot:Q().min(0).max(12),courage:Q().min(2).max(12),armor:Q().min(0).max(6),attackValue:Q().min(0).max(6),defenceValue:Q().min(0).max(6),shootValue:Q().min(0).max(6),shootRange:Q().min(0).max(24),movement:Q().min(0).max(18),strengthPoints:Q().oneOf([5,10])}),ka=Te({attack:Q().min(-12).max(12),move:Q().min(-12).max(12),shoot:Q().min(-12).max(12),courage:Q().min(-12).max(12),armor:Q().min(-6).max(6),attackValue:Q().min(-6).max(6),defenceValue:Q().min(-6).max(6),shootValue:Q().min(-6).max(6),shootRange:Q().min(-6).max(24),movement:Q().min(-18).max(18),strengthPoints:Q().oneOf([-10,-5,0,5,10])}),Aa=Te({name:K().min(1).required(),points:Q().required(),description:K().required(),short:K(),remove:Me().of(K()),add:Me().of(K()),setStats:Hn,adjustStats:ka,disabledBy:Me().of(K()),enabledBy:Me().of(K())}),Ad=Te({name:K().min(1).required(),type:K(),points:Q().min(1).required(),stats:Hn,rules:Me().of(K()),xenosRules:Me().of(K()),freeActivations:Me().of(K()),options:_d(Aa)}),Cr={name:"",points:0,description:""},Pd={name:"Name",type:"foot",points:2,stats:{attack:5,move:6,shoot:0,courage:4,armor:2,attackValue:5,defenceValue:5,shootValue:0,shootRange:0,movement:6,strengthPoints:5},freeActivations:[],rules:[],options:{},xenosRules:[]},Td=({open:t,handleClose:n,option:a,rules:r,onSubmit:o})=>{const s=ge(R=>R.data.rulesData),h=_t({resolver:Fn(Aa),defaultValues:{...a}}),{reset:c,watch:d,setValue:f,handleSubmit:v}=h;M.useEffect(()=>{t&&c({...a})},[c,t,a]);const y=R=>{R.preventDefault(),R.stopPropagation(),v(x)(R)},x=R=>{o(R),n()};return e.jsxs(me,{onClose:n,open:t,children:[e.jsx(fe,{children:"Option"}),e.jsxs(Ye,{formContext:h,handleSubmit:y,children:[e.jsxs(je,{children:[e.jsx(oe,{name:"name",label:"Name",type:"text",margin:"normal",fullWidth:!0}),e.jsx(Be,{name:"points",label:"Points",margin:"normal",type:"number",fullWidth:!0,options:le(-4,6)}),e.jsx(oe,{name:"description",label:"Description",type:"text",margin:"normal",fullWidth:!0,multiline:!0,style:{marginBottom:20}}),e.jsx(oe,{name:"short",label:"Short description",type:"text",margin:"normal",fullWidth:!0,multiline:!0}),e.jsx(Ke,{name:"remove",label:"Remove Rules",fullWidth:!0,menuItems:[...r],style:{marginBottom:20}}),e.jsx(Ke,{name:"add",label:"Add Rules",fullWidth:!0,menuItems:[...Object.keys(s)],style:{marginBottom:20}}),e.jsx(gt,{title:"Set Stats",type:"setStats",watch:d,setValue:f}),e.jsx(gt,{title:"Adjust Stats",type:"adjustStats",watch:d,setValue:f})]}),e.jsxs(Se,{children:[e.jsx(z,{onClick:n,color:"primary",children:"Cancel"}),e.jsx(z,{type:"submit",color:"primary",children:"Okay"})]})]})]})},Ce=({stat:t,isPhone:n})=>{const a=He[t];return e.jsxs(e.Fragment,{children:[e.jsx(ne,{children:n?a.shortName:a.name}),e.jsx(ne,{children:e.jsx(Be,{name:"stats."+t,type:"number",options:a.range})})]})},Id=()=>{const t=Jt(),n=yt(t.breakpoints.down("xs"));return e.jsxs(e.Fragment,{children:[e.jsx(Rt,{id:"stats-label",style:{marginTop:15},children:"Stats"}),e.jsx(jt,{style:{marginBottom:15},children:e.jsx(St,{size:"small",children:e.jsxs(wt,{children:[e.jsxs(he,{children:[e.jsx(Ce,{stat:"attack",isPhone:n}),e.jsx(Ce,{stat:"attackValue",isPhone:n})]}),e.jsxs(he,{children:[e.jsx(Ce,{stat:"move",isPhone:n}),e.jsx(Ce,{stat:"defenceValue",isPhone:n})]}),e.jsxs(he,{children:[e.jsx(Ce,{stat:"shoot",isPhone:n}),e.jsx(Ce,{stat:"shootValue",isPhone:n})]}),e.jsxs(he,{children:[e.jsx(Ce,{stat:"courage",isPhone:n}),e.jsx(Ce,{stat:"shootRange",isPhone:n})]}),e.jsxs(he,{children:[e.jsx(Ce,{stat:"armor",isPhone:n}),e.jsx(Ce,{stat:"movement",isPhone:n})]})]})})})]})},Dd=[{id:"attack",title:"Attack"},{id:"move",title:"Move"},{id:"shoot",title:"Shoot"}];function Md(t){const{formContext:n,open:a,handleClose:r,handleAction:o,validateName:s}=t,{watch:h,setValue:c}=n,d=ge(P=>P.data.rulesData),[f,v,y]=de(),[x,R]=M.useState({...Cr}),I=P=>{c("options",{...h("options"),[P.name]:P})},$=P=>{R(h("options")[P]),v()},F=P=>{c("options",Ue(h("options"),Z=>{delete Z[P]}))},Y=()=>{R(Cr),v()};return e.jsx(me,{open:a,children:e.jsxs(Ye,{formContext:n,onSuccess:o,children:[e.jsx(fe,{children:"Unit"}),e.jsxs(je,{children:[e.jsx(oe,{name:"name",label:"Name",type:"text",margin:"normal",fullWidth:!0,customError:P=>!s(P)}),e.jsx(Be,{name:"points",label:"Points",margin:"normal",type:"number",fullWidth:!0,options:le(1,10)}),e.jsx(Be,{name:"stats.strengthPoints",label:"Strength Points",margin:"normal",type:"number",fullWidth:!0,options:[5,10]}),e.jsx(Id,{}),e.jsx(Ke,{name:"freeActivations",label:"Free Activations",fullWidth:!0,style:{marginBottom:15},valueKey:"id",labelKey:"title",menuItems:[...Dd]}),e.jsx(Ke,{name:"rules",label:"Rules",fullWidth:!0,style:{marginBottom:15},menuItems:[...Object.keys(d)]}),e.jsx(Rt,{id:"options-label",children:"Options"}),e.jsx(_a,{data:h("options"),handleClickActionOne:$,handleClickActionTwo:F,handleClickSpecialAction:Y}),e.jsx(Td,{open:f,handleClose:y,option:x,rules:h("rules"),onSubmit:I})]}),e.jsxs(Se,{children:[e.jsx(z,{onClick:r,color:"primary",children:"Cancel"}),e.jsx(z,{type:"submit",color:"primary",children:"Okay"})]})]})})}function Ed(t){const{expanded:n,handleChange:a}=t,r=Ve(),o=ge(d=>d.data.customData.unitData),s=ge(d=>d.roster.units),h=d=>{Object.values(s).some(f=>f.name===d)?r(ie("You can't delete a unit currently in use!","error")):r(Ri(d))},c=d=>r(Ci(d));return e.jsx(Pt,{name:"Units",id:"units",expanded:n,handleChange:a,data:o,CustomForm:Md,schema:Ad,emptyState:{...Pd},removeFunc:h,addFunc:c})}const Vd=B.memo(Ed);function Od(t){const{formContext:n,open:a,handleClose:r,handleAction:o,validateName:s}=t,h=ge(f=>Wr(f)),{watch:c,setValue:d}=n;return e.jsx(me,{open:a,children:e.jsxs(Ye,{formContext:n,onSuccess:o,children:[e.jsx(fe,{children:"Xenos Rule"}),e.jsxs(je,{children:[e.jsx(oe,{name:"name",label:"Name",type:"text",margin:"normal",fullWidth:!0,customError:f=>!s(f)}),e.jsx(Be,{name:"points",label:"Points",margin:"normal",type:"number",fullWidth:!0,options:le(-4,6)}),e.jsx(oe,{name:"description",label:"Description",type:"text",margin:"normal",fullWidth:!0,multiline:!0}),e.jsx(oe,{name:"short",label:"Short description",type:"text",margin:"normal",fullWidth:!0,multiline:!0}),e.jsx(Ke,{name:"exclude_units",label:"Exclude Units",fullWidth:!0,menuItems:[...h]}),e.jsx(gt,{title:"Set Stats",type:"setStats",watch:c,setValue:d}),e.jsx(gt,{title:"Adjust Stats",type:"adjustStats",watch:c,setValue:d})]}),e.jsxs(Se,{children:[e.jsx(z,{onClick:r,color:"primary",children:"Cancel"}),e.jsx(z,{type:"submit",color:"primary",children:"Okay"})]})]})})}const $d=Te({name:K().min(1).required(),points:Q().min(0).required(),exclude_units:Me().of(K()),description:K().required(),short:K(),setStats:Hn,adjustStats:ka}),Fd={name:"Name",points:0,exclude_units:[],description:"Description"};function Bd(t){const{expanded:n,handleChange:a}=t,r=Ve(),o=ge(d=>d.data.customData.xenosRulesData),s=ge(d=>d.roster.units),h=d=>{Object.values(s).some(f=>f.xenosRules.includes(d))?r(ie("You can't delete a rule currently in use!","error")):r(ki(d))},c=d=>r(_i(d));return e.jsx(Pt,{name:"Xenos Rules",id:"xenos-rules",expanded:n,handleChange:a,data:o,CustomForm:Od,schema:$d,emptyState:{...Fd},removeFunc:h,addFunc:c})}const Wd=B.memo(Bd),Ld=()=>{const[t,n]=M.useState(""),[a,r,o]=de(),[s,h,c]=de(),d=M.useCallback(f=>(v,y)=>{n(y?f:"")},[]);return e.jsxs(e.Fragment,{children:[e.jsx(fe,{children:"Customize"}),e.jsx(Vd,{expanded:t,handleChange:d}),e.jsx(Wd,{expanded:t,handleChange:d}),e.jsx(Cd,{expanded:t,handleChange:d}),e.jsx(xd,{expanded:t,handleChange:d}),e.jsx(E,{m:2,mx:"auto",children:e.jsxs(Tr,{color:"primary",variant:"outlined",children:[e.jsx(z,{"aria-label":"Import custom data",startIcon:e.jsx(Vn,{}),onClick:()=>r(),children:"Import"}),e.jsx(z,{"aria-label":"Export custom data",startIcon:e.jsx(Mn,{}),onClick:()=>h(),children:"Export"})]})}),e.jsx(rd,{open:a,handleClose:o}),e.jsx(td,{open:s,handleClose:c})]})},Nd=B.memo(Ld),zd=()=>{const t=ge(a=>a.appState.customizeMode),n=Ve();return e.jsx(me,{open:t,onClose:()=>n(Vr(!1)),children:e.jsx(Nd,{})})},Hd=B.memo(zd),Ud=$e(t=>({root:{backgroundColor:t.palette.background.default,color:t.palette.text.primary,border:0,marginTop:25,marginBottom:25,width:"100%"}})),qd=()=>{const t=Ud(),n=U(),a=D(o=>o.roster.name),r=D(o=>o.appState.inputUpdate);return e.jsx(Pe,{children:e.jsx(T,{className:t.root,"aria-label":"List name",variant:"h2",component:"input",value:a,onChange:o=>n(is({name:o.target.value}))},r.toString())})};var Un={},Gd=W,Yd=L;Object.defineProperty(Un,"__esModule",{value:!0});var Pa=Un.default=void 0,Xd=Yd(M),Qd=Gd(H()),Jd=(0,Qd.default)(Xd.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");Pa=Un.default=Jd;const Kd=()=>{const t=U(),n=D(c=>ns(c)),a=D(c=>c.ui.powersExpanded),[r,o]=M.useState([...Array(Object.keys(n))].map(()=>!1)),s=n&&Object.keys(n).length>0,h=c=>{const d=[...r];d[c]=!r[c],o(d)};return e.jsx(e.Fragment,{children:s&&e.jsxs(tt,{expanded:a,onChange:()=>t(ot("powersExpanded")),style:{maxWidth:1210,marginBottom:20},children:[e.jsx(nt,{expandIcon:e.jsx(Ee,{}),children:e.jsx(T,{variant:"h3",children:"Psychic Power Table"})}),e.jsxs(rt,{style:{maxWidth:800},children:[e.jsx(Ae,{smDown:!0,children:e.jsx(jt,{children:e.jsxs(St,{size:"small",style:{minWidth:650},children:[e.jsx(Pr,{children:e.jsxs(he,{children:[e.jsx(ne,{style:{minWidth:120},children:"Power name"}),e.jsx(Ae,{smDown:!0,children:e.jsx(ne,{align:"center",children:"Difficulty"})}),e.jsx(Ae,{mdUp:!0,children:e.jsx(ne,{align:"center",children:"Dif"})}),e.jsx(ne,{children:"Target"}),e.jsx(ne,{children:"Duration"}),e.jsx(ne,{children:"Effect"})]},"headpowertable")}),e.jsx(wt,{children:Object.values(n).map(c=>e.jsxs(he,{children:[e.jsx(ne,{component:"th",scope:"row",children:c.name}),e.jsxs(ne,{align:"center",children:[c.difficulty,"+"]}),e.jsx(ne,{children:c.target}),e.jsx(ne,{children:c.duration}),e.jsx(ne,{children:c.effect})]},c.name))})]})})}),e.jsx(Ae,{mdUp:!0,children:e.jsx(be,{children:Object.values(n).map((c,d)=>e.jsxs(E,{children:[e.jsxs(q,{button:!0,onClick:()=>h(d),children:[e.jsx(ue,{primary:c.name}),e.jsx(E,{width:25}),r[d]?e.jsx(Pa,{}):e.jsx(Ee,{})]},c.name+"small"),e.jsx(_r,{in:r[d],timeout:"auto",unmountOnExit:!0,children:e.jsxs(be,{dense:!0,style:{paddingLeft:20},children:[e.jsx(q,{children:e.jsx(ue,{primary:"Difficulty: ",secondary:c.difficulty})},c.name+c.difficulty),e.jsx(q,{children:e.jsx(ue,{primary:"Target: ",secondary:c.target})},c.name+c.target),e.jsx(q,{children:e.jsx(ue,{primary:"Duration: ",secondary:c.duration})},c.name+c.duration),e.jsx(q,{children:e.jsx(ue,{primary:"Effect: ",secondary:c.effect})},c.name+c.effect)]},c.name+"list")})]},d))})})]})]})})},Zd=()=>{const t=U(),n=D(r=>r.ui.rulesSummaryExpanded),a=D(r=>ts(r));return e.jsxs(tt,{expanded:n,onChange:()=>t(ot("rulesSummaryExpanded")),style:{maxWidth:1210,marginBottom:20},children:[e.jsx(nt,{expandIcon:e.jsx(Ee,{}),children:e.jsx(T,{variant:"h3",children:"Rules Summary"})}),e.jsx(rt,{style:{maxWidth:800},children:e.jsx(be,{children:Object.values(a).map(r=>e.jsx(q,{children:e.jsx(ue,{primary:r.name,secondary:r.description||""})},r.name))})})]})},eh=()=>{const t=U(),n=D(r=>r.appState.feedback),a=(r,o)=>{o!=="clickaway"&&t(hi())};return e.jsx(Zo,{open:n.open,autoHideDuration:6e3,onClose:a,children:e.jsx(ei,{onClose:a,severity:n.severity,variant:"filled",elevation:6,children:n.message})})};var qn={},th=W,nh=L;Object.defineProperty(qn,"__esModule",{value:!0});var Ta=qn.default=void 0,rh=nh(M),ah=th(H()),oh=(0,ah.default)(rh.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"}),"Error");Ta=qn.default=oh;const ih=$e(t=>({title:{backgroundColor:t.palette.error.main,color:t.palette.error.contrastText},details:{backgroundColor:t.palette.error.light,color:t.palette.error.contrastText}})),sh=()=>{const t=U(),n=D(s=>s.ui.validationExpanded),a=ih(),r=Object.values(D(s=>s.roster.units)),o=[];for(const s of r){const h=!s.xenosRules.some(c=>["Psychic 1","Psychic 2","Psychic 3","Psychic 4"].includes(c));s.points>12&&o.push([s.name,"No Unit may cost more than 12 points!"]),s.name!=="Unit"&&s.points<1&&o.push([s.name,"No Unit may cost less than one point!"]),s.xenosRules.includes("Fanatical Discipline")&&s.stats.courage<3&&o.push([s.name,"This unit can´t have less than 3 courage!"]),s.xenosRules.includes("Hive Mind")&&s.xenosRules.includes("Commander")&&o.push([s.name,"A Commander can´t have Hive Mind!"]),s.xenosRules.includes("Slow")&&s.options.includes("Mobile")&&o.push([s.name,"Slow and Mobile can´t be used together!"]),s.xenosRules.includes("Contagious")&&!(s.xenosRules.includes("Demonic")||s.xenosRules.includes("Undead"))&&o.push([s.name,"Conatagious can only be taken by demonic or undead units!"]),s.xenosRules.includes("Psychic Hazards")&&!h&&o.push([s.name,"Only a psychic unit can take Psychic Hazards!"]),(s.xenosRules.includes("Psychic Species 1")||s.xenosRules.includes("Psychic Species 2")||s.xenosRules.includes("Psychic Species 3"))&&!h&&o.push([s.name,"Only a psychic unit can take Psychic Species!"]),s.xenosRules.includes("Psychic 1")&&s.psiPowers&&s.psiPowers.length>1&&o.push([s.name,"A Psychic 1 unit can only take 1 Psychic Power!"]),s.xenosRules.includes("Psychic 2")&&s.psiPowers&&s.psiPowers.length>2&&o.push([s.name,"A Psychic 2 unit can only take 2 Psychic Powers!"]),s.xenosRules.includes("Psychic 3")&&s.psiPowers&&s.psiPowers.length>3&&o.push([s.name,"A Psychic 3 unit can only take 3 Psychic Powers!"]),s.xenosRules.includes("Psychic 4")&&s.psiPowers&&s.psiPowers.length>3&&o.push([s.name,"A Psychic 4 unit can only take 3 Psychic Powers!"])}return e.jsx(e.Fragment,{children:o.length!==0&&e.jsxs(tt,{expanded:n,onChange:()=>t(ot("validationExpanded")),style:{maxWidth:1210},children:[e.jsx(nt,{className:a.title,expandIcon:e.jsx(Ee,{className:a.title}),children:e.jsx(T,{variant:"h3",children:"Warnings"})}),e.jsx(rt,{className:a.details,children:e.jsx(be,{children:o.map(([s,h],c)=>e.jsxs(q,{children:[e.jsx(Yt,{className:a.details,children:e.jsx(Ta,{})}),e.jsx(ue,{primary:s,secondary:h})]},c))})})]})})},lh=()=>{const t=pi(),n=U();return M.useEffect(()=>{n($r())},[n]),e.jsxs(ti,{theme:t,children:[e.jsx(ni,{}),e.jsxs(xt,{children:[e.jsx(yu,{}),e.jsx(qd,{}),e.jsx(Vl,{}),e.jsx(sh,{}),e.jsx(Zd,{}),e.jsx(Kd,{}),e.jsx(ed,{}),e.jsx(eh,{}),e.jsx(Hd,{})]})]})};Do.render(e.jsx(Oo,{store:qt,children:e.jsx(lh,{})}),document.getElementById("root"));
